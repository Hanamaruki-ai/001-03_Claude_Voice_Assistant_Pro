[Claude Voice Assistant Pro -APIå…¥æ‰‹å¼.html](https://github.com/user-attachments/files/22309704/Claude.Voice.Assistant.Pro.-API.html)[ClaudeVoicePro_with_Summary.html](https://github.com/user-attachments/files/22306278/ClaudeVoicePro_with_Summary.html)# 001-03_Claude_Voice_Assistant_Pro

ä¿¡ã˜ã‚‰ã‚Œãªã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€ã“ã®ã‚¢ãƒ—ãƒªã¯ã€AIã«ã€Œè©±ã—ã‹ã‘ãŸã ã‘ã€ã§ç”Ÿã¾ã‚Œã¾ã—ãŸã€‚
ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã¨ã„ã†è‹¦ç—›ã‹ã‚‰è§£æ”¾ã•ã‚Œã€æ€è€ƒã®æµã‚Œã‚’æ­¢ã‚ãšã«AIã¨å¯¾è©±ã™ã‚‹ã€‚ãã‚“ãªå¤¢ã®ã‚ˆã†ãªä½“é¨“ã‚’ã€ã‚ãªãŸã‚‚ã€‚

---

## âœ¨ ç‰¹é•·
### ğŸ™ï¸ éŸ³å£°å…¥åŠ›ã§ã‚¹ãƒ ãƒ¼ã‚ºãªå¯¾è©±

ãƒã‚¤ã‚¯ã«è©±ã—ã‹ã‘ã‚‹ã ã‘ã§ã€ç¬æ™‚ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’ç”Ÿæˆã€‚é ­ã«æµ®ã‹ã‚“ã ã‚¢ã‚¤ãƒ‡ã‚¢ã‚„æ–‡ç« ã‚’ã€æ€è€ƒã‚’é€”åˆ‡ã‚Œã•ã›ã‚‹ã“ã¨ãªãæ›¸ãèµ·ã“ã›ã¾ã™ã€‚

### ğŸ¤– AIã¨ã®å¯¾è©±é©å‘½

ãƒã‚¤ã‚¯å…¥åŠ›ã‚’æŒãŸãªã„AIã¨ã®ä¼šè©±ã‚’åŠ‡çš„ã«åŠ¹ç‡åŒ–ã—ã¾ã™ã€‚ ã“ã®ã‚¢ãƒ—ãƒªã§éŸ³å£°ã‹ã‚‰ãƒ†ã‚­ã‚¹ãƒˆã‚’ç”Ÿæˆã—ã€ãã‚Œã‚’Claudeã‚„Qwenãªã©ã®AIã«ã‚³ãƒ”ãƒ¼ï¼†ãƒšãƒ¼ã‚¹ãƒˆã™ã‚‹ã ã‘ã§ã€ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã®ã‚¹ãƒˆãƒ¬ã‚¹ã‹ã‚‰å®Œå…¨ã«è§£æ”¾ã•ã‚Œã¾ã™ã€‚

### ğŸ¨ ã‚·ãƒ³ãƒ—ãƒ«ã§ç›´æ„Ÿçš„ãªUI

è¤‡é›‘ãªè¨­å®šã¯ä¸€åˆ‡ä¸è¦ã€‚èª°ã§ã‚‚ç›´æ„Ÿçš„ã«ä½¿ã„å§‹ã‚ã‚‰ã‚Œã‚‹ã‚ˆã†ã€ã‚·ãƒ³ãƒ—ãƒ«ã•ã‚’è¿½æ±‚ã—ã¦è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚

ğŸ“– é–‹ç™ºã®è£å´ï¼šAIã¨ã®å…±å‰µã‚¹ãƒˆãƒ¼ãƒªãƒ¼
ã“ã®ã‚¢ãƒ—ãƒªã¯ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°çµŒé¨“ã®ãªã„ä¸€äººã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€ã€Œã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã˜ã‚ƒãªãã¦ã€è©±ã—ã‹ã‘ã‚‰ã‚ŒãŸã‚‰æ¥½ãªã®ã«ã€ã¨AIï¼ˆClaudeï¼‰ã«è©±ã—ã‹ã‘ãŸã“ã¨ãŒãã£ã‹ã‘ã§èª•ç”Ÿã—ã¾ã—ãŸã€‚
AIã¯ã€ãã®ä¸€è¨€ã‚’é€ƒã•ãšã€è‡ªã‚‰ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå§‹ã‚ã€å¯¾è©±ã‚’é€šã˜ã¦å®Œæˆã¸ã¨å°ã„ã¦ãã‚ŒãŸã®ã§ã™ã€‚
ã“ã®å¯¾è©±ã®å…¨è¨˜éŒ²ã¯ã€æ›¸ç±**ã€AIã«è©±ã—ã‹ã‘ãŸã‚‰ã‚¢ãƒ—ãƒªãŒã§ãã¡ã‚ƒã£ãŸã€**ã¨ã—ã¦ã€Kindleã§å‡ºç‰ˆã•ã‚Œã¦ã„ã¾ã™ã€‚

---

## â¡ï¸ æ›¸ç±ã¯ã“ã¡ã‚‰ã‹ã‚‰
### AIã«è©±ã—ã‹ã‘ãŸã‚‰ã‚¢ãƒ—ãƒªãŒã§ãã¡ã‚ƒã£ãŸ ASIN: B0FNKPFMVD
https://amzn.to/3JsBgA1?tag=hanamaruki0aid-22

### I Talked to an AI, and It Built an App ASIN: B0FNKSJRSC
https://amzn.to/4oRH1HC?tag=Hanamaruki020


ã“ã®ä½œå“ã¯ã€äººé–“ã¨AIã®æ–°ã—ã„ã€Œå…±å‰µã€ã®å½¢ã§ã‚ã‚Šã€èª°ã§ã‚‚AIã¨å”åŠ›ã—ã¦ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’å½¢ã«ã§ãã‚‹å¯èƒ½æ€§ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚

---

### ğŸ“ ä¸»ãªä½¿ç”¨ä¾‹
æ›¸ç±ãƒ»åŸç¨¿åŸ·ç­†: PCã§ã®ä½œæ¥­ã«ç‰¹åŒ–ã™ã‚‹ã“ã¨ã§ã€è†¨å¤§ãªãƒ†ã‚­ã‚¹ãƒˆã‚’åŠ¹ç‡çš„ã«æ‰±ãˆã¾ã™ã€‚ã€æ›¸ç±ãŒæ›¸ã‘ã‚‹ v1.2 Proã€ã®ã‚ˆã†ãªAIãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«ã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€åŸ·ç­†ä½œæ¥­ã‚’é£›èºçš„ã«åŠ¹ç‡åŒ–ã§ãã¾ã™ã€‚

ã‚¢ã‚¤ãƒ‡ã‚¢å‡ºã—ãƒ»ãƒ–ãƒ¬ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒŸãƒ³ã‚°: æ€è€ƒã‚’è¨€è‘‰ã«ã™ã‚‹ã ã‘ã§ã€æ¬¡ã€…ã¨ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’è¨˜éŒ²ã§ãã¾ã™ã€‚

AIã¨ã®åŠ¹ç‡çš„ãªã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³: ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ãŒè‹¦æ‰‹ãªæ–¹ã§ã‚‚ã€ã‚¹ãƒˆãƒ¬ã‚¹ãªãAIã¨æ·±ãå¯¾è©±ã§ãã¾ã™ã€‚

## ğŸ’» å‹•ä½œç’°å¢ƒ
PCï¼ˆWindows/Macï¼‰ã§ã®åˆ©ç”¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

ãƒã‚¤ã‚¯ã‚’æ­è¼‰ã—ãŸPC

æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®Webãƒ–ãƒ©ã‚¦ã‚¶ï¼ˆGoogle Chromeã€Microsoft Edgeãªã©ã‚’æ¨å¥¨ï¼‰

## Demo

---

## ğŸ“¥ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã‹ã‚‰ã€ã‚¢ãƒ—ãƒªã®ã‚³ãƒ¼ãƒ‰ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰ã€æŠ€è¡“ä»•æ§˜æ›¸ã‚’ã¾ã¨ã‚ãŸZIPãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚

### â¡ï¸ ã‚¢ãƒ—ãƒªã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ã¾ã¨ã‚ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
[Docs.zip](https://github.com/user-attachments/files/22309643/Docs.zip)
* Claude Voice Assistant Pro -APIå…¥æ‰‹å¼.html
ã€€ ã‚¢ãƒ—ãƒªæœ¬ä½“
* Claude Voice Assistant Pro_ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰.md
ã€€  ã‚¢ãƒ—ãƒªä»•æ§˜æ›¸
* APIã‚­ãƒ¼ç¿’å¾—ãƒãƒ‹ãƒ¥ã‚¢ãƒ«/md
ã€€  APIã‚­ãƒ¼ã‚’å–å¾—ã—ã¦ä½¿ã†ã¨ãã®ãƒãƒ‹ãƒ¥ã‚¢ãƒ«
* Claude Voice Assistant Pro -APIå…¥æ‰‹å¼.html.png
ã€€ ã‚¢ãƒ—ãƒªã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
* Claude Voice Assistant Pro - æŠ€è¡“ä»•æ§˜æ›¸.md
ã€€ ã‚¢ãƒ—ãƒªæŠ€è¡“ä»•æ§˜æ›¸
* 20250912_MIT License.txt
  ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å†…å®¹

### ä½¿ã„æ–¹ãŒã‚ã‹ã‚‰ãªã„å ´åˆã¯ãƒ•ã‚¡ã‚¤ãƒ«ã‚’Aiã«èª­ã¿è¾¼ã¾ã›ã¦ä½¿ã„æ–¹ã‚’èã„ã¦ã¿ã¦ãã ã•ã„ã€‚

---

## ğŸ“„ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå†…å®¹
ä»¥ä¸‹ã®å†…å®¹ã‚’å‚è€ƒã«ã€ã‚¢ãƒ—ãƒªã®è©³ç´°ã‚’ç¢ºèªã§ãã¾ã™ã€‚

## 1. ã‚¢ãƒ—ãƒªæœ¬ä½“ã®ã‚³ãƒ¼ãƒ‰ (Claude Voice Assistant Pro -APIå…¥æ‰‹å¼.html)
[Uploading Claude Voice Assistant Pro -APIå…¥æ‰‹
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claude Voice Assistant Pro</title>
    <style>
        /* å…¨ä½“çš„ãªãƒªã‚»ãƒƒãƒˆã¨åŸºæœ¬è¨­å®š */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }
        
        /* ã‚³ãƒ³ãƒ†ãƒŠ */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* ãƒ˜ãƒƒãƒ€ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }
        
        .header p {
            color: #666;
            font-size: 1.1em;
        }
        
        /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        /* éŸ³å£°ãƒ‘ãƒãƒ« */
        .voice-panel {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        /* éŸ³å£°ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒœã‚¿ãƒ³ç¾¤ */
        .voice-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .voice-btn {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            font-size: 28px;
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .voice-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }
        
        /* ãƒã‚¤ã‚¯ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .mic-btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
        }
        
        .mic-btn.listening {
            background: linear-gradient(45deg, #f44336, #da190b);
            animation: pulse 1.5s infinite;
        }
        
        /* ãã®ä»–ã®ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .stop-btn {
            background: linear-gradient(45deg, #f44336, #da190b);
            color: white;
        }
        
        .copy-btn {
            background: linear-gradient(45deg, #2196F3, #1976D2);
            color: white;
        }
        
        .clear-btn {
            background: linear-gradient(45deg, #ff9800, #f57c00);
            color: white;
        }
        
        .save-btn {
            background: linear-gradient(45deg, #9c27b0, #7b1fa2);
            color: white;
        }

        /* ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .download-btn {
            background: linear-gradient(45deg, #42a5f5, #1e88e5); /* é’ç³»ã®ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ */
            color: white;
        }
        
        .voice-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }
        
        /* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º */
        .status-display {
            background: linear-gradient(45deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
            color: #495057;
        }
        
        .status-display.listening {
            background: linear-gradient(45deg, #d4edda, #c3e6cb);
            color: #155724;
            border: 2px solid #28a745;
        }
        
        .status-display.error {
            background: linear-gradient(45deg, #f8d7da, #f5c6cb);
            color: #721c24;
            border: 2px solid #dc3545;
        }
        
        /* ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã‚³ãƒ³ãƒ†ãƒŠ */
        .textarea-container {
            position: relative;
        }
        
        textarea {
            width: 100%;
            height: 300px;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            font-size: 16px;
            line-height: 1.6;
            resize: vertical;
            font-family: inherit;
            background: #fafafa;
            transition: all 0.3s ease;
        }
        
        textarea:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        /* ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ãƒ„ãƒ¼ãƒ«ãƒœã‚¿ãƒ³ */
        .textarea-tools {
            position: absolute;
            bottom: 10px;
            right: 10px;
            display: flex;
            gap: 10px;
        }
        
        .tool-btn {
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 20px;
            padding: 8px 12px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }
        
        .tool-btn:hover {
            background: white;
            transform: translateY(-1px);
        }
        
        /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        /* è¨­å®šãƒ‘ãƒãƒ«ï¼ˆdetailsè¦ç´ ã¨ã—ã¦å†å®šç¾©ï¼‰ */
        .settings-panel details {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .settings-panel summary {
            font-size: 1.5em; /* h3ã®ã‚µã‚¤ã‚ºã«åˆã‚ã›ã‚‹ */
            font-weight: bold;
            color: #333;
            cursor: pointer;
            margin-bottom: 15px;
            list-style: none; /* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒãƒ¼ã‚«ãƒ¼ã‚’éè¡¨ç¤ºã« */
            display: flex;
            align-items: center;
        }

        .settings-panel summary::before {
            content: 'âš™ï¸ '; /* æ­¯è»Šã‚¢ã‚¤ã‚³ãƒ³ */
            margin-right: 10px;
        }

        .settings-panel details[open] summary {
            margin-bottom: 20px; /* é–‹ã„ãŸã¨ãã«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¨ã®é–“ã«ã‚¹ãƒšãƒ¼ã‚¹ */
        }
        
        .setting-item {
            margin-bottom: 15px;
        }
        
        .setting-item label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #555;
        }
        
        .setting-item select,
        .setting-item input[type="checkbox"] {
            width: auto; /* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®å¹…ã‚’è‡ªå‹•èª¿æ•´ */
            margin-right: 8px; /* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã¨ãƒ©ãƒ™ãƒ«ã®é–“ã«ã‚¹ãƒšãƒ¼ã‚¹ */
        }

        .setting-item input[type="text"],
        .setting-item input[type="password"], /* è¿½åŠ  */
        .setting-item select {
            width: 100%;
            padding: 8px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }
        
        .setting-item select:focus,
        .setting-item input[type="text"]:focus,
        .setting-item input[type="password"]:focus { /* è¿½åŠ  */
            outline: none;
            border-color: #667eea;
        }

        .setting-item.checkbox-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .setting-item.checkbox-item label {
            margin-bottom: 0;
        }

        /* ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼é¸æŠã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .download-format-options {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 10px;
        }
        .download-format-options label {
            display: flex;
            align-items: center;
            margin-bottom: 0; /* è¦ªè¦ç´ ã®margin-bottomãŒã‚ã‚‹ã®ã§ãƒªã‚»ãƒƒãƒˆ */
            font-weight: normal;
        }
        .download-format-options input[type="checkbox"] {
            margin-right: 8px;
        }

        /* ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .reset-button {
            background: linear-gradient(45deg, #ef5350, #d32f2f); /* èµ¤ç³»ã®ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ */
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 15px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
            width: 100%;
            margin-top: 10px;
        }
        .reset-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .reset-group {
            margin-top: 20px;
            border-top: 1px solid #eee;
            padding-top: 15px;
        }
        
        /* ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ‘ãƒãƒ« */
        .templates-panel {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .template-item {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .template-item:hover {
            background: #e9ecef;
            transform: translateY(-1px);
        }
        
        .template-item h4 {
            margin-bottom: 5px;
            color: #333;
            font-size: 14px;
        }
        
        .template-item p {
            font-size: 12px;
            color: #666;
            margin: 0;
        }
        
        /* å±¥æ­´ãƒ‘ãƒãƒ« */
        .history-panel {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            max-height: 300px; /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ã«ã™ã‚‹ */
            overflow-y: auto;
        }
        
        .history-item {
            background: #f8f9fa;
            border: 1px solid #e9ecef; /* å±¥æ­´ã‚¢ã‚¤ãƒ†ãƒ ã®ãƒœãƒ¼ãƒ€ãƒ¼ã‚’è¿½åŠ  */
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 4px solid #667eea;
        }
        
        .history-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }
        
        .history-item-date {
            font-size: 11px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .history-item-text {
            font-size: 13px;
            color: #333;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap; /* 1è¡Œã§è¡¨ç¤º */
        }
        
        /* çµ±è¨ˆãƒ‘ãƒãƒ« */
        .stats-panel {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-radius: 20px;
            padding: 20px;
            color: white;
            text-align: center;
        }
        
        .stats-item {
            margin-bottom: 15px;
        }
        
        .stats-number {
            font-size: 2em;
            font-weight: bold;
            display: block;
        }
        
        .stats-label {
            font-size: 0.9em;
            opacity: 0.8;
        }
        
        /* æ–‡å­—æ•°ãƒ»å˜èªæ•°è¡¨ç¤º */
        .word-count {
            text-align: right;
            color: #666;
            margin-top: 10px;
            font-size: 14px;
        }
        
        /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ */
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr; /* 1åˆ—ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã«å¤‰æ›´ */
            }
            
            .voice-controls {
                gap: 10px;
            }
            
            .voice-btn {
                width: 60px;
                height: 60px;
                font-size: 24px;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }

        /* ãƒã‚¤ã‚¯ã‚¬ã‚¤ãƒ‰ãƒ¢ãƒ¼ãƒ€ãƒ« */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            max-width: 500px;
            text-align: center;
            transform: translateY(-20px);
            transition: transform 0.3s ease;
        }

        .modal-overlay.active .modal-content {
            transform: translateY(0);
        }

        .modal-content h3 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .modal-content p {
            margin-bottom: 15px;
            line-height: 1.6;
            color: #555;
        }

        .modal-content ul {
            list-style: none;
            padding: 0;
            margin-bottom: 20px;
            text-align: left;
            color: #666;
        }

        .modal-content ul li {
            margin-bottom: 10px;
            padding-left: 0; /* ãƒã‚§ãƒƒã‚¯ãƒãƒ¼ã‚¯ã‚’å‰Šé™¤ã—ãŸã®ã§ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚‚ä¸è¦ */
            position: relative;
        }

        /* ãƒã‚§ãƒƒã‚¯ãƒãƒ¼ã‚¯ã‚’å‰Šé™¤ */
        .modal-content ul li::before {
            content: none; 
        }

        .modal-close-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 25px;
            padding: 12px 25px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1em;
        }

        .modal-close-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¤ Claude Voice Assistant Pro</h1>
            <p>éŸ³å£°å…¥åŠ›ã§Claudeæ´»ç”¨ã‚’æœ€å¤§åŒ–ï¼ãƒ—ãƒ­ä»•æ§˜ã®éŸ³å£°èªè­˜ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ</p>
        </div>
        
        <div class="main-content">
            <div class="voice-panel">
                <div class="status-display" id="statusDisplay">
                    æº–å‚™å®Œäº† - ãƒã‚¤ã‚¯ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦é–‹å§‹
                </div>
                
                <div class="voice-controls">
                    <button class="voice-btn mic-btn" id="micBtn" title="éŸ³å£°å…¥åŠ›é–‹å§‹">
                        ğŸ¤
                    </button>
                    <button class="voice-btn stop-btn" id="stopBtn" title="éŒ²éŸ³åœæ­¢" disabled>
                        â¹ï¸
                    </button>
                    <button class="voice-btn copy-btn" id="copyBtn" title="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼">
                        ğŸ“‹
                    </button>
                    <button class="voice-btn clear-btn" id="clearBtn" title="ãƒ†ã‚­ã‚¹ãƒˆã‚¯ãƒªã‚¢">
                        ğŸ—‘ï¸
                    </button>
                    <button class="voice-btn save-btn" id="saveBtn" title="å±¥æ­´ã«ä¿å­˜">
                        ğŸ’¾
                    </button>
                    <button class="voice-btn download-btn" id="downloadBtn" title="ãƒ†ã‚­ã‚¹ãƒˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰">
                        â¬‡ï¸
                    </button>
                </div>
                
                <div class="textarea-container">
                    <textarea id="textOutput" placeholder="éŸ³å£°ã§å…¥åŠ›ã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

ğŸ¯ Claudeæ´»ç”¨ã®ã‚³ãƒ„ï¼š
â€¢ ã€Œã€œã«ã¤ã„ã¦è©³ã—ãæ•™ãˆã¦ã€
â€¢ ã€Œã€œã‚’åˆ†ã‹ã‚Šã‚„ã™ãèª¬æ˜ã—ã¦ã€
â€¢ ã€Œã€œã®ãƒ¡ãƒªãƒƒãƒˆã¨ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã¯ï¼Ÿã€
â€¢ ã€Œã€œã‚’è¦ç´„ã—ã¦ã€

å³å´ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚‚æ´»ç”¨ã—ã¦ãã ã•ã„ï¼"></textarea>
<!-- è¦ç´„ãƒœã‚¿ãƒ³ -->
<div class="summary-container" style="text-align: right; margin-top: 10px;">
  <button id="summarizeBtn" class="tool-btn">ğŸ§  è¦ç´„ã™ã‚‹</button>
</div>

                    <div class="textarea-tools">
                        <button class="tool-btn" id="undoBtn">â†¶ å…ƒã«æˆ»ã™</button>
                        <button class="tool-btn" id="redoBtn">â†· ã‚„ã‚Šç›´ã—</button>
                    </div>
                </div>
                
                <div class="word-count">
                    æ–‡å­—æ•°: <span id="charCount">0</span> | å˜èªæ•°: <span id="wordCount">0</span>
                </div>
            </div>
            
            <div class="sidebar">
                <div class="settings-panel">
                    <details open> <!-- openå±æ€§ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§é–‹ã -->
                        <summary>è¨­å®š</summary>
                        <div class="setting-item">
                            <label for="openaiApiKey">OpenAI APIã‚­ãƒ¼</label>
                            <input type="password" id="openaiApiKey" placeholder="sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx">
                            <p style="font-size: 0.8em; color: #888; margin-top: 5px;">
                                â€»å€‹äººã§å–å¾—ã—ãŸAPIã‚­ãƒ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚<br>
                                OpenAIã‚¢ã‚«ã‚¦ãƒ³ãƒˆ: <a href="https://platform.openai.com/api-keys" target="_blank" rel="noopener noreferrer">platform.openai.com/api-keys</a>
                            </p>
                        </div>
                        <div class="setting-item">
                            <label for="language">è¨€èª</label>
                            <select id="language">
                                <option value="ja-JP">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
                                <option value="en-US">ğŸ‡ºğŸ‡¸ English</option>
                                <option value="en-GB">ğŸ‡¬ğŸ‡§ English (UK)</option>
                                <option value="zh-CN">ğŸ‡¨  ä¸­æ–‡</option>
                                <option value="ko-KR">ğŸ‡°ğŸ‡· í•œêµ­ì–´</option>
                            </select>
                        </div>
                        <div class="setting-item checkbox-item">
                            <label for="autoSave">è‡ªå‹•ä¿å­˜</label>
                            <input type="checkbox" id="autoSave" checked>
                        </div>
                        <div class="setting-item checkbox-item">
                            <label for="showMicrophoneGuide">ãƒã‚¤ã‚¯è¨­å®šã‚¬ã‚¤ãƒ‰ã‚’è¡¨ç¤º</label>
                            <input type="checkbox" id="showMicrophoneGuide" checked>
                        </div>
                        <div class="setting-item">
                            <label for="theme">ãƒ†ãƒ¼ãƒ</label>
                            <select id="theme">
                                <option value="default">ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ</option>
                                <option value="dark">ãƒ€ãƒ¼ã‚¯</option>
                                <option value="minimal">ãƒŸãƒ‹ãƒãƒ«</option>
                            </select>
                        </div>

                        <div class="setting-item">
                            <label>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å½¢å¼</label>
                            <div class="download-format-options" id="downloadFormatOptions">
                                <label><input type="checkbox" id="downloadFormat_txt" value="txt" data-mime-type="text/plain;charset=utf-8" data-extension="txt" checked> ğŸ“„ ãƒ†ã‚­ã‚¹ãƒˆ (.txt)</label>
                                <label><input type="checkbox" id="downloadFormat_md" value="md" data-mime-type="text/markdown;charset=utf-8" data-extension="md"> ğŸ“ ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ (.md)</label>
                                <label><input type="checkbox" id="downloadFormat_html" value="html" data-mime-type="text/html;charset=utf-8" data-extension="html"> ğŸŒ HTML (.html)</label>
                                <label><input type="checkbox" id="downloadFormat_json" value="json" data-mime-type="application/json;charset=utf-8" data-extension="json"> ğŸ’» JSON (.json)</label>
                                <label><input type="checkbox" id="downloadFormat_csv" value="csv" data-mime-type="text/csv;charset=utf-8" data-extension="csv"> ğŸ“Š CSV (.csv)</label>
                            </div>
                        </div>

                        <div class="reset-group">
                            <button class="reset-button" id="resetHistoryBtn">ğŸ“š å±¥æ­´ã‚’ãƒªã‚»ãƒƒãƒˆ</button>
                            <button class="reset-button" id="resetStatsBtn">ğŸ“Š çµ±è¨ˆã‚’ãƒªã‚»ãƒƒãƒˆ</button>
                        </div>
                    </details>
                </div>
                
                <div class="templates-panel">
                    <h3>ğŸ“ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</h3>
                    <div class="template-item" data-template="ã«ã¤ã„ã¦è©³ã—ãæ•™ãˆã¦ãã ã•ã„ã€‚ç‰¹ã«ä»¥ä¸‹ã®ç‚¹ã‚’å«ã‚ã¦èª¬æ˜ã—ã¦ãã ã•ã„ï¼š">
                        <h4>è©³ç´°èª¬æ˜</h4>
                        <p>ãƒˆãƒ”ãƒƒã‚¯ã«ã¤ã„ã¦è©³ã—ãèª¬æ˜ã—ã¦ã‚‚ã‚‰ã†</p>
                    </div>
                    <div class="template-item" data-template="ã‚’åˆ†ã‹ã‚Šã‚„ã™ãè¦ç´„ã—ã¦ãã ã•ã„ã€‚è¦ç‚¹ã‚’ç®‡æ¡æ›¸ãã§æ•™ãˆã¦ãã ã•ã„ï¼š">
                        <h4>è¦ç´„ãƒ»æ•´ç†</h4>
                        <p>å†…å®¹ã‚’æ•´ç†ã—ã¦è¦ç´„ã—ã¦ã‚‚ã‚‰ã†</p>
                    </div>
                    <div class="template-item" data-template="ã®ãƒ¡ãƒªãƒƒãƒˆã¨ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã‚’æ•™ãˆã¦ãã ã•ã„ã€‚æ¯”è¼ƒè¡¨ãŒã‚ã‚‹ã¨åŠ©ã‹ã‚Šã¾ã™ï¼š">
                        <h4>æ¯”è¼ƒåˆ†æ</h4>
                        <p>ãƒ¡ãƒªãƒƒãƒˆãƒ»ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã‚’æ¯”è¼ƒåˆ†æ</p>
                    </div>
                    <div class="template-item" data-template="ã«ã¤ã„ã¦åˆå¿ƒè€…ã«ã‚‚åˆ†ã‹ã‚‹ã‚ˆã†ã«èª¬æ˜ã—ã¦ãã ã•ã„ã€‚å…·ä½“ä¾‹ã‚‚å«ã‚ã¦ï¼š">
                        <h4>åˆå¿ƒè€…å‘ã‘</h4>
                        <p>å°‚é–€ç”¨èªã‚’ä½¿ã‚ãšåˆ†ã‹ã‚Šã‚„ã™ãèª¬æ˜</p>
                    </div>
                </div>
                
                <div class="history-panel">
                    <h3>ğŸ“š å±¥æ­´</h3>
                    <div id="historyList">
                        <!-- å±¥æ­´ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
                    </div>
                </div>
                
                <div class="stats-panel">
                    <h3>ğŸ“Š çµ±è¨ˆ</h3>
                    <div class="stats-item">
                        <span class="stats-number" id="totalSessions">0</span>
                        <span class="stats-label">ã‚»ãƒƒã‚·ãƒ§ãƒ³æ•°</span>
                    </div>
                    <div class="stats-item">
                        <span class="stats-number" id="totalWords">0</span>
                        <span class="stats-label">ç·å˜èªæ•°</span>
                    </div>
                    <div class="stats-item">
                        <span class="stats-number" id="totalTime">0</span>
                        <span class="stats-label">ç·åˆ©ç”¨æ™‚é–“(åˆ†)</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ãƒã‚¤ã‚¯ã‚¬ã‚¤ãƒ‰ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div class="modal-overlay" id="microphoneGuideModal">
        <div class="modal-content">
            <h3>ãƒã‚¤ã‚¯è¨­å®šã®ãŠé¡˜ã„</h3>
            <p>ã“ã®ã‚¢ãƒ—ãƒªã¯éŸ³å£°å…¥åŠ›ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ãƒã‚¤ã‚¯ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ãªã„å ´åˆã€ä»¥ä¸‹ã®æ‰‹é †ã§è¨­å®šã‚’ã”ç¢ºèªãã ã•ã„ã€‚</p>
            <ul>
                <li>ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼ã«è¡¨ç¤ºã•ã‚Œã‚‹ãƒã‚¤ã‚¯ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆã¾ãŸã¯å—äº¬éŒ ã‚¢ã‚¤ã‚³ãƒ³ï¼‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚</li>
                <li>ã€Œãƒã‚¤ã‚¯ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã€ã¾ãŸã¯ã€Œã‚µã‚¤ãƒˆã®è¨­å®šã€ã§ã€ã“ã®ã‚µã‚¤ãƒˆã®ãƒã‚¤ã‚¯ä½¿ç”¨ã‚’ã€Œè¨±å¯ã€ã«è¨­å®šã—ã¦ãã ã•ã„ã€‚</li>
                <li>ã‚‚ã—ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨­å®šã§è¨±å¯ã§ããªã„å ´åˆã¯ã€ãŠä½¿ã„ã®OSï¼ˆWindows/macOS/Android/iOSï¼‰ã®ã‚·ã‚¹ãƒ†ãƒ è¨­å®šã§ãƒ–ãƒ©ã‚¦ã‚¶ã‚¢ãƒ—ãƒªã®ãƒã‚¤ã‚¯ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã—ã¦ãã ã•ã„ã€‚</li>
            </ul>
            <button class="modal-close-btn" id="closeMicrophoneGuideModal">OKã€ç†è§£ã—ã¾ã—ãŸ</button>
        </div>
    </div>

    <script>
        class VoiceAssistantPro {
            constructor() {
                this.recognition = null;
                this.isListening = false;
                this.finalTranscript = '';
                this.undoStack = [];
                this.redoStack = [];
                this.sessionStartTime = null;
                this.stats = this.loadStats();
                this.history = this.loadHistory();
                this.showMicrophoneGuideOnStartup = this.loadMicrophoneGuideSetting(); // ãƒã‚¤ã‚¯ã‚¬ã‚¤ãƒ‰è¨­å®šã‚’ãƒ­ãƒ¼ãƒ‰
                this.hasRequestedMicrophonePermission = false; // ãƒã‚¤ã‚¯è¨±å¯ã‚’ä¸€åº¦ã§ã‚‚è¦æ±‚ã—ãŸã‹ã©ã†ã‹ã®ãƒ•ãƒ©ã‚°
                this.downloadFormats = this.loadDownloadFormatSettings(); // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å½¢å¼è¨­å®šã‚’ãƒ­ãƒ¼ãƒ‰
                this.openaiApiKey = this.loadOpenAIApiKey(); // OpenAI APIã‚­ãƒ¼ã‚’ãƒ­ãƒ¼ãƒ‰

                this.initElements();
                this.initSpeechRecognition();
                this.bindEvents();
                this.updateCharCount();
                this.updateStats();
                this.loadHistoryDisplay();
                this.applyDownloadFormatSettings(); // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å½¢å¼è¨­å®šã‚’é©ç”¨
                this.checkMicrophonePermissionAndShowGuide(); // ãƒã‚¤ã‚¯è¨±å¯ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€å¿…è¦ãªã‚‰ã‚¬ã‚¤ãƒ‰ã‚’è¡¨ç¤º

                // åˆæœŸãƒ­ãƒ¼ãƒ‰æ™‚ã«APIã‚­ãƒ¼å…¥åŠ›æ¬„ã«å€¤ã‚’è¨­å®š
                if (this.openaiApiKeyInput) {
                    this.openaiApiKeyInput.value = this.openaiApiKey;
                }
            }
            
            initElements() {
                this.micBtn = document.getElementById('micBtn');
                this.stopBtn = document.getElementById('stopBtn');
                this.copyBtn = document.getElementById('copyBtn');
                this.clearBtn = document.getElementById('clearBtn');
                this.saveBtn = document.getElementById('saveBtn');
                this.downloadBtn = document.getElementById('downloadBtn');
                this.downloadFormatCheckboxes = document.querySelectorAll('#downloadFormatOptions input[type="checkbox"]'); // å¤‰æ›´
                this.undoBtn = document.getElementById('undoBtn');
                this.redoBtn = document.getElementById('redoBtn');
                this.summarizeBtn = document.getElementById('summarizeBtn'); // è¿½åŠ 

                this.statusDisplay = document.getElementById('statusDisplay');
                this.textOutput = document.getElementById('textOutput');
                this.languageSelect = document.getElementById('language');
                this.charCount = document.getElementById('charCount');
                this.wordCount = document.getElementById('wordCount');
                
                this.totalSessions = document.getElementById('totalSessions');
                this.totalWords = document.getElementById('totalWords');
                this.totalTime = document.getElementById('totalTime');
                this.historyList = document.getElementById('historyList');
                
                this.templateItems = document.querySelectorAll('.template-item');

                // æ–°ã—ã„ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³
                this.resetHistoryBtn = document.getElementById('resetHistoryBtn');
                this.resetStatsBtn = document.getElementById('resetStatsBtn');

                // ãƒã‚¤ã‚¯ã‚¬ã‚¤ãƒ‰ãƒ¢ãƒ¼ãƒ€ãƒ«é–¢é€£è¦ç´ 
                this.microphoneGuideModal = document.getElementById('microphoneGuideModal');
                this.closeMicrophoneGuideModalBtn = document.getElementById('closeMicrophoneGuideModal');
                this.showMicrophoneGuideCheckbox = document.getElementById('showMicrophoneGuide');

                // OpenAI APIã‚­ãƒ¼å…¥åŠ›æ¬„
                this.openaiApiKeyInput = document.getElementById('openaiApiKey'); // è¿½åŠ 

                // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®åˆæœŸçŠ¶æ…‹ã‚’è¨­å®š
                this.showMicrophoneGuideCheckbox.checked = this.showMicrophoneGuideOnStartup;
            }
            
            initSpeechRecognition() {
                // ãƒ–ãƒ©ã‚¦ã‚¶ãŒéŸ³å£°èªè­˜APIã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹ã‹ç¢ºèª
                if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                    this.updateStatus('éŸ³å£°èªè­˜éå¯¾å¿œãƒ–ãƒ©ã‚¦ã‚¶ã§ã™', 'error');
                    this.micBtn.disabled = true;
                    return;
                }
                
                // SpeechRecognitionã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®åˆæœŸåŒ–
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                this.recognition = new SpeechRecognition();
                
                // ç¶™ç¶šçš„ãªèªè­˜ã¨ä¸­é–“çµæœã®å–å¾—ã‚’æœ‰åŠ¹ã«ã™ã‚‹
                this.recognition.continuous = true;
                this.recognition.interimResults = true;
                // é¸æŠã•ã‚ŒãŸè¨€èªã‚’è¨­å®š
                this.recognition.lang = this.languageSelect.value;
                
                // èªè­˜é–‹å§‹æ™‚ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©
                this.recognition.onstart = () => {
                    this.isListening = true;
                    this.sessionStartTime = Date.now(); // ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚é–“ã‚’è¨˜éŒ²
                    this.micBtn.classList.add('listening'); // ãƒã‚¤ã‚¯ãƒœã‚¿ãƒ³ã«ãƒªã‚¹ãƒ‹ãƒ³ã‚°ä¸­ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’é©ç”¨
                    this.micBtn.disabled = true; // ãƒã‚¤ã‚¯ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
                    this.stopBtn.disabled = false; // åœæ­¢ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
                    this.updateStatus('èã„ã¦ã„ã¾ã™... è©±ã—ã¦ãã ã•ã„', 'listening');
                };
                
                // èªè­˜çµæœãŒå¾—ã‚‰ã‚ŒãŸæ™‚ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©
                this.recognition.onresult = (event) => {
                    let interimTranscript = ''; // ä¸­é–“çµæœã‚’æ ¼ç´ã™ã‚‹å¤‰æ•°
                    
                    // ã™ã¹ã¦ã®èªè­˜çµæœã‚’ãƒ«ãƒ¼ãƒ—
                    for (let i = event.resultIndex; i < event.results.length; i++) {
                        const transcript = event.results[i][0].transcript;
                        
                        // æœ€çµ‚çµæœã¨ä¸­é–“çµæœã‚’åˆ†é›¢
                        if (event.results[i].isFinal) {
                            this.finalTranscript += transcript + ' '; // æœ€çµ‚çµæœã«è¿½åŠ 
                        } else {
                            interimTranscript += transcript; // ä¸­é–“çµæœã«è¿½åŠ 
                        }
                    }
                    
                    // ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã«æœ€çµ‚çµæœã¨ä¸­é–“çµæœã‚’è¡¨ç¤º
                    this.textOutput.value = this.finalTranscript + interimTranscript;
                    this.updateCharCount(); // æ–‡å­—æ•°ãƒ»å˜èªæ•°ã‚’æ›´æ–°
                };
                
                // ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©
                this.recognition.onerror = (event) => {
                    console.error('éŸ³å£°èªè­˜ã‚¨ãƒ©ãƒ¼:', event.error);
                    this.updateStatus(`ã‚¨ãƒ©ãƒ¼: ${event.error}`, 'error');
                    this.resetButtons(); // ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ

                    // ãƒã‚¤ã‚¯è¨±å¯ã‚¨ãƒ©ãƒ¼ã®å ´åˆã€ã‚¬ã‚¤ãƒ‰ã‚’è¡¨ç¤º
                    if (event.error === 'not-allowed' || event.error === 'permission-denied') {
                        this.showMicrophoneGuideModal();
                    }
                };
                
                // èªè­˜çµ‚äº†æ™‚ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©
                this.recognition.onend = () => {
                    this.isListening = false;
                    this.updateSessionStats(); // ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ±è¨ˆã‚’æ›´æ–°
                    
                    // ãƒã‚¤ã‚¯è¨±å¯ãŒæ—¢ã«è¦æ±‚ã•ã‚Œã¦ãŠã‚Šã€ã‹ã¤ã‚¬ã‚¤ãƒ‰è¡¨ç¤ºè¨­å®šãŒONã®å ´åˆã«è£œè¶³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ 
                    if (this.hasRequestedMicrophonePermission && this.showMicrophoneGuideOnStartup) {
                        this.updateStatus('èªè­˜å®Œäº† - å†åº¦é–‹å§‹ã™ã‚‹ã«ã¯ãƒã‚¤ã‚¯ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚â€»ãƒ–ãƒ©ã‚¦ã‚¶ã®ä»•æ§˜ã«ã‚ˆã‚Šã€å†åº¦è¨±å¯ã‚’æ±‚ã‚ã‚‰ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚');
                    } else {
                        this.updateStatus('èªè­˜å®Œäº† - å†åº¦é–‹å§‹ã™ã‚‹ã«ã¯ãƒã‚¤ã‚¯ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„');
                    }
                    this.resetButtons(); // ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
                };
            }
            
            // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®ãƒã‚¤ãƒ³ãƒ‰
            bindEvents() {
                this.micBtn.addEventListener('click', () => this.startRecognition());
                this.stopBtn.addEventListener('click', () => this.stopRecognition());
                this.copyBtn.addEventListener('click', () => this.copyText());
                this.clearBtn.addEventListener('click', () => this.clearText());
                this.saveBtn.addEventListener('click', () => this.saveToHistory());
                this.downloadBtn.addEventListener('click', () => this.downloadTextsInSelectedFormats()); // å¤‰æ›´
                this.undoBtn.addEventListener('click', () => this.undo());
                this.redoBtn.addEventListener('click', () => this.redo());
                this.summarizeBtn.addEventListener('click', () => this.summarizeText()); // è¿½åŠ 
                
                // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å½¢å¼ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®å¤‰æ›´ã‚¤ãƒ™ãƒ³ãƒˆ
                this.downloadFormatCheckboxes.forEach(checkbox => {
                    checkbox.addEventListener('change', () => this.saveDownloadFormatSettings());
                });

                // ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆ
                this.resetHistoryBtn.addEventListener('click', () => this.resetHistory());
                this.resetStatsBtn.addEventListener('click', () => this.resetStats());
                
                // è¨€èªé¸æŠãŒå¤‰æ›´ã•ã‚ŒãŸã‚‰èªè­˜è¨€èªã‚’æ›´æ–°
                this.languageSelect.addEventListener('change', () => {
                    if (this.recognition) {
                        this.recognition.lang = this.languageSelect.value;
                    }
                });
                
                // ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã®å…¥åŠ›æ™‚ã«ã‚¢ãƒ³ãƒ‰ã‚¥ã‚¹ã‚¿ãƒƒã‚¯ã‚’æ›´æ–°ã—ã€æ–‡å­—æ•°ãƒ»å˜èªæ•°ã‚’æ›´æ–°
                this.textOutput.addEventListener('input', () => {
                    this.saveToUndoStack();
                    this.updateCharCount();
                });
                
                // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¢ã‚¤ãƒ†ãƒ ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
                this.templateItems.forEach(item => {
                    item.addEventListener('click', () => {
                        const template = item.dataset.template;
                        this.insertTemplate(template);
                    });
                });
                
                // ãƒã‚¤ã‚¯ã‚¬ã‚¤ãƒ‰ãƒ¢ãƒ¼ãƒ€ãƒ«ã®é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³
                this.closeMicrophoneGuideModalBtn.addEventListener('click', () => {
                    this.hideMicrophoneGuideModal();
                });

                // ãƒã‚¤ã‚¯ã‚¬ã‚¤ãƒ‰è¡¨ç¤ºè¨­å®šã®å¤‰æ›´
                this.showMicrophoneGuideCheckbox.addEventListener('change', (e) => {
                    this.showMicrophoneGuideOnStartup = e.target.checked;
                    this.saveMicrophoneGuideSetting();
                });

                // OpenAI APIã‚­ãƒ¼å…¥åŠ›æ¬„ã®å¤‰æ›´ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ 
                this.openaiApiKeyInput.addEventListener('input', (e) => {
                    this.openaiApiKey = e.target.value.trim();
                    this.saveOpenAIApiKey(this.openaiApiKey);
                    this.updateStatus('APIã‚­ãƒ¼ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚');
                });

                // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ
                document.addEventListener('keydown', (e) => {
                    if (e.ctrlKey || e.metaKey) { // Ctrlã‚­ãƒ¼ã¾ãŸã¯Cmdã‚­ãƒ¼ãŒæŠ¼ã•ã‚Œã¦ã„ã‚‹å ´åˆ
                        switch(e.key) {
                            case 'm': // Ctrl/Cmd + M ã§éŒ²éŸ³é–‹å§‹/åœæ­¢
                                e.preventDefault();
                                if (!this.isListening) {
                                    this.startRecognition();
                                } else {
                                    this.stopRecognition();
                                }
                                break;
                            case 'z': // Ctrl/Cmd + Z ã§å…ƒã«æˆ»ã™, Ctrl/Cmd + Shift + Z ã§ã‚„ã‚Šç›´ã—
                                if (e.shiftKey) {
                                    e.preventDefault();
                                    this.redo();
                                } else {
                                    e.preventDefault();
                                    this.undo();
                                }
                                break;
                            case 's': // Ctrl/Cmd + S ã§å±¥æ­´ã«ä¿å­˜
                                e.preventDefault();
                                this.saveToHistory();
                                break;
                            case 'd': // Ctrl/Cmd + D ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                                e.preventDefault();
                                this.downloadTextsInSelectedFormats();
                                break;
                            case 'y': // Ctrl/Cmd + Y ã§è¦ç´„
                                e.preventDefault();
                                this.summarizeText();
                                break;
                        }
                    }
                });
            }
            
            // éŸ³å£°èªè­˜ã‚’é–‹å§‹
            startRecognition() {
                if (!this.recognition) return;
                
                this.saveToUndoStack(); // ç¾åœ¨ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¢ãƒ³ãƒ‰ã‚¥ã‚¹ã‚¿ãƒƒã‚¯ã«ä¿å­˜
                
                try {
                    this.recognition.start();
                } catch (error) {
                    console.error('éŒ²éŸ³é–‹å§‹ã‚¨ãƒ©ãƒ¼:', error);
                    this.updateStatus('éŒ²éŸ³é–‹å§‹ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
                    // ã‚¨ãƒ©ãƒ¼ãŒãƒã‚¤ã‚¯è¨±å¯é–¢é€£ã®å ´åˆã€ã‚¬ã‚¤ãƒ‰ã‚’è¡¨ç¤º
                    if (error.name === 'NotAllowedError' || error.name === 'PermissionDeniedError') {
                        this.showMicrophoneGuideModal();
                    }
                }
            }
            
            // éŸ³å£°èªè­˜ã‚’åœæ­¢
            stopRecognition() {
                if (this.recognition && this.isListening) {
                    this.recognition.stop();
                }
            }
            
            // ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã®å†…å®¹ã‚’ã‚¯ãƒªã‚¢
            clearText() {
                this.saveToUndoStack(); // ã‚¯ãƒªã‚¢å‰ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¢ãƒ³ãƒ‰ã‚¥ã‚¹ã‚¿ãƒƒã‚¯ã«ä¿å­˜
                this.textOutput.value = '';
                this.finalTranscript = '';
                this.updateCharCount();
                this.updateStatus('ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ');
            }
            
            // ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼
            async copyText() {
                const text = this.textOutput.value;
                if (!text.trim()) {
                    this.updateStatus('ã‚³ãƒ”ãƒ¼ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆãŒã‚ã‚Šã¾ã›ã‚“', 'error');
                    return;
                }
                
                try {
                    await navigator.clipboard.writeText(text);
                    this.updateStatus('ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼');
                } catch (error) {
                    console.error('ã‚³ãƒ”ãƒ¼ã‚¨ãƒ©ãƒ¼:', error);
                    this.textOutput.select();
                    this.updateStatus('ãƒ†ã‚­ã‚¹ãƒˆã‚’é¸æŠã—ã¾ã—ãŸï¼ˆæ‰‹å‹•ã§ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ï¼‰', 'error');
                }
            }

            // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å½¢å¼ã«å¿œã˜ãŸãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆã¨MIMEã‚¿ã‚¤ãƒ—ãƒ»æ‹¡å¼µå­ã®å–å¾—
            getFormattedDownloadData(originalText, format) {
                let content = originalText;
                let mimeType = '';
                let extension = '';

                switch (format) {
                    case 'txt':
                        mimeType = 'text/plain;charset=utf-8';
                        extension = 'txt';
                        break;
                    case 'md':
                        mimeType = 'text/markdown;charset=utf-8';
                        extension = 'md';
                        break;
                    case 'html':
                        const escapedText = originalText.replace(/&/g, '&amp;')
                                                      .replace(/</g, '&lt;')
                                                      .replace(/>/g, '&gt;')
                                                      .replace(/"/g, '&quot;')
                                                      .replace(/'/g, '&#039;');
                        content = `<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Claude Voice Assistant Output</title>
</head>
<body>
    <pre>${escapedText}</pre>
</body>
</html>`;
                        mimeType = 'text/html;charset=utf-8';
                        extension = 'html';
                        break;
                    case 'json':
                        content = JSON.stringify({
                            title: `Claude Voice Assistant Output`,
                            content: originalText,
                            timestamp: new Date().toISOString()
                        }, null, 2); // 2ã‚¹ãƒšãƒ¼ã‚¹ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã§æ•´å½¢
                        mimeType = 'application/json;charset=utf-8';
                        extension = 'json';
                        break;
                    case 'csv':
                        const csvEscapedText = originalText.replace(/"/g, '""');
                        content = `"${csvEscapedText}"`; // å…¨ä½“ã‚’1ã¤ã®ã‚»ãƒ«ã¨ã—ã¦ä¿å­˜
                        mimeType = 'text/csv;charset=utf-8';
                        extension = 'csv';
                        break;
                    default:
                        mimeType = 'text/plain;charset=utf-8';
                        extension = 'txt';
                        break;
                }
                return { content, mimeType, extension };
            }

            // é¸æŠã•ã‚ŒãŸå…¨ã¦ã®å½¢å¼ã§ãƒ†ã‚­ã‚¹ãƒˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
            downloadTextsInSelectedFormats() {
                const originalText = this.textOutput.value;
                if (!originalText.trim()) {
                    this.updateStatus('ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆãŒã‚ã‚Šã¾ã›ã‚“', 'error');
                    return;
                }

                const checkedFormats = Array.from(this.downloadFormatCheckboxes)
                                            .filter(cb => cb.checked)
                                            .map(cb => ({
                                                format: cb.value,
                                                mimeType: cb.dataset.mimeType,
                                                extension: cb.dataset.extension
                                            }));

                if (checkedFormats.length === 0) {
                    this.updateStatus('ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å½¢å¼ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚è¨­å®šã‹ã‚‰é¸ã‚“ã§ãã ã•ã„ã€‚', 'error');
                    return;
                }

                // ãƒ•ã‚¡ã‚¤ãƒ«åã®æ—¥ä»˜éƒ¨åˆ†ã‚’ç”Ÿæˆ (YYYYMMDD_HH-MM)
                const now = new Date();
                const year = now.getFullYear();
                const month = (now.getMonth() + 1).toString().padStart(2, '0');
                const day = now.getDate().toString().padStart(2, '0');
                const hours = now.getHours().toString().padStart(2, '0');
                const minutes = now.getMinutes().toString().padStart(2, '0');
                const datetimePrefix = `${year}${month}${day}_${hours}-${minutes}`;

                let downloadedCount = 0;

                checkedFormats.forEach(({ format, mimeType, extension }) => {
                    const { content, mimeType: finalMimeType, extension: finalExtension } = this.getFormattedDownloadData(originalText, format);
                    const filename = `${datetimePrefix}.${finalExtension}`;

                    const blob = new Blob([content], { type: finalMimeType });
                    const a = document.createElement('a');
                    a.href = URL.createObjectURL(blob);
                    a.download = filename;
                    
                    // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’ãƒˆãƒªã‚¬ãƒ¼
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(a.href);
                    downloadedCount++;
                });

                this.updateStatus(`${downloadedCount}å€‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸï¼`);
            }
            
            // ãƒ†ã‚­ã‚¹ãƒˆã‚’å±¥æ­´ã«ä¿å­˜
            saveToHistory() {
                const text = this.textOutput.value;
                if (!text.trim()) {
                    this.updateStatus('ä¿å­˜ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆãŒã‚ã‚Šã¾ã›ã‚“', 'error');
                    return;
                }
                
                const historyItem = {
                    id: Date.now(), // ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªID
                    text: text,
                    date: new Date().toLocaleString('ja-JP'), // æ—¥æœ¬èªãƒ­ã‚±ãƒ¼ãƒ«ã§æ—¥ä»˜ã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
                    wordCount: this.countWords(text)
                };
                
                this.history.unshift(historyItem); // é…åˆ—ã®å…ˆé ­ã«è¿½åŠ 
                
                // æœ€å¤§100ä»¶ã¾ã§ä¿å­˜ã—ã€å¤ã„ã‚‚ã®ã‹ã‚‰å‰Šé™¤
                if (this.history.length > 100) {
                    this.history = this.history.slice(0, 100);
                }
                
                this.saveHistory(); // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
                this.loadHistoryDisplay(); // å±¥æ­´è¡¨ç¤ºã‚’æ›´æ–°
                this.updateStatus('å±¥æ­´ã«ä¿å­˜ã—ã¾ã—ãŸ');
            }

            // å±¥æ­´ã®ãƒªã‚»ãƒƒãƒˆ
            resetHistory() {
                if (confirm('å…¨ã¦ã®å±¥æ­´ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ')) {
                    this.history = [];
                    this.saveHistory();
                    this.loadHistoryDisplay();
                    this.updateStatus('å±¥æ­´ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ');
                }
            }

            // çµ±è¨ˆã®ãƒªã‚»ãƒƒãƒˆ
            resetStats() {
                if (confirm('å…¨ã¦ã®çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ')) {
                    this.stats = { totalSessions: 0, totalWords: 0, totalTime: 0 };
                    this.saveStats();
                    this.updateStats();
                    this.updateStatus('çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ');
                }
            }
            
            // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã«æŒ¿å…¥
            insertTemplate(template) {
                this.saveToUndoStack(); // æŒ¿å…¥å‰ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¢ãƒ³ãƒ‰ã‚¥ã‚¹ã‚¿ãƒƒã‚¯ã«ä¿å­˜
                const cursorPos = this.textOutput.selectionStart; // ç¾åœ¨ã®ã‚«ãƒ¼ã‚½ãƒ«ä½ç½®
                const textBefore = this.textOutput.value.substring(0, cursorPos);
                const textAfter = this.textOutput.value.substring(cursorPos);
                
                this.textOutput.value = textBefore + template + textAfter; // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’æŒ¿å…¥
                this.textOutput.focus(); // ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
                // ã‚«ãƒ¼ã‚½ãƒ«ä½ç½®ã‚’ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®æœ«å°¾ã«ç§»å‹•
                this.textOutput.selectionStart = this.textOutput.selectionEnd = cursorPos + template.length;
                
                this.updateCharCount();
                this.updateStatus('ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’æŒ¿å…¥ã—ã¾ã—ãŸ');
            }
            
            // ç¾åœ¨ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¢ãƒ³ãƒ‰ã‚¥ã‚¹ã‚¿ãƒƒã‚¯ã«ä¿å­˜
            saveToUndoStack() {
                // ç¾åœ¨ã®ãƒ†ã‚­ã‚¹ãƒˆãŒã‚¹ã‚¿ãƒƒã‚¯ã®æœ€å¾Œã¨åŒã˜å ´åˆã¯ä¿å­˜ã—ãªã„ï¼ˆé€£ç¶šå…¥åŠ›ã«ã‚ˆã‚‹é‡è¤‡ã‚’é˜²ãï¼‰
                if (this.undoStack.length > 0 && this.undoStack[this.undoStack.length - 1] === this.textOutput.value) {
                    return;
                }
                this.undoStack.push(this.textOutput.value);
                this.redoStack = []; // ã‚¢ãƒ³ãƒ‰ã‚¥ã—ãŸå ´åˆã¯ãƒªãƒ‰ã‚¥ã‚¹ã‚¿ãƒƒã‚¯ã‚’ã‚¯ãƒªã‚¢
                
                // æœ€å¤§50ä»¶ã¾ã§ä¿å­˜ã—ã€å¤ã„ã‚‚ã®ã‹ã‚‰å‰Šé™¤
                if (this.undoStack.length > 50) {
                    this.undoStack.shift();
                }
            }
            
            // å…ƒã«æˆ»ã™ (Undo)
            undo() {
                if (this.undoStack.length === 0) return;
                
                this.redoStack.push(this.textOutput.value); // ç¾åœ¨ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ãƒªãƒ‰ã‚¥ã‚¹ã‚¿ãƒƒã‚¯ã«ä¿å­˜
                this.textOutput.value = this.undoStack.pop(); // ã‚¹ã‚¿ãƒƒã‚¯ã‹ã‚‰ä¸€ã¤å‰ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’å–å¾—
                this.updateCharCount();
                this.updateStatus('å…ƒã«æˆ»ã—ã¾ã—ãŸ');
            }
            
            // ã‚„ã‚Šç›´ã— (Redo)
            redo() {
                if (this.redoStack.length === 0) return;
                
                this.undoStack.push(this.textOutput.value); // ç¾åœ¨ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¢ãƒ³ãƒ‰ã‚¥ã‚¹ã‚¿ãƒƒã‚¯ã«ä¿å­˜
                this.textOutput.value = this.redoStack.pop(); // ã‚¹ã‚¿ãƒƒã‚¯ã‹ã‚‰ä¸€ã¤å¾Œã®ãƒ†ã‚­ã‚¹ãƒˆã‚’å–å¾—
                this.updateCharCount();
                this.updateStatus('ã‚„ã‚Šç›´ã—ã¾ã—ãŸ');
            }
            
            // ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
            resetButtons() {
                this.micBtn.classList.remove('listening');
                this.micBtn.disabled = false;
                this.stopBtn.disabled = true;
            }
            
            // æ–‡å­—æ•°ã¨å˜èªæ•°ã‚’æ›´æ–°
            updateCharCount() {
                const text = this.textOutput.value;
                const charCount = text.length;
                const wordCount = this.countWords(text);
                
                this.charCount.textContent = charCount.toLocaleString();
                this.wordCount.textContent = wordCount.toLocaleString();
            }
            
            // ãƒ†ã‚­ã‚¹ãƒˆã®å˜èªæ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ (æ—¥æœ¬èªã¨è‹±èªã§ç•°ãªã‚‹ãƒ­ã‚¸ãƒƒã‚¯)
            countWords(text) {
                if (!text.trim()) return 0;
                
                // æ—¥æœ¬èªã®æ–‡å­—ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã¯æ–‡å­—æ•°ï¼ˆç©ºç™½ãªã—ï¼‰ã‚’è¿”ã™
                if (/[\u3400-\u9FBF\u3040-\u309F\u30A0-\u30FF]/.test(text)) { // Unicodeã®CJKçµ±åˆæ¼¢å­—ã€ã²ã‚‰ãŒãªã€ã‚«ã‚¿ã‚«ãƒŠã®ç¯„å›²ã‚’ãƒã‚§ãƒƒã‚¯
                    return text.replace(/\s+/g, '').length;
                } else {
                    // è‹±èªã®å ´åˆã¯ã‚¹ãƒšãƒ¼ã‚¹ã§åŒºåˆ‡ã‚‰ã‚ŒãŸå˜èªæ•°ã‚’è¿”ã™
                    return text.trim().split(/\s+/).length;
                }
            }

            // ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ±è¨ˆã‚’æ›´æ–°
            updateSessionStats() {
                if (this.sessionStartTime) {
                    const sessionDuration = (Date.now() - this.sessionStartTime) / (1000 * 60); // ãƒŸãƒªç§’ã‹ã‚‰åˆ†ã«å¤‰æ›
                    this.stats.totalTime += sessionDuration;
                    this.stats.totalSessions++;
                    this.stats.totalWords += this.countWords(this.finalTranscript);
                    this.saveStats(); // çµ±è¨ˆã‚’ä¿å­˜
                    this.updateStats(); // çµ±è¨ˆè¡¨ç¤ºã‚’æ›´æ–°
                    this.sessionStartTime = null; // ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚é–“ã‚’ãƒªã‚»ãƒƒãƒˆ
                }
            }

            // çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰èª­ã¿è¾¼ã‚€
            loadStats() {
                try {
                    const stats = JSON.parse(localStorage.getItem('voiceAssistantStats')) || { totalSessions: 0, totalWords: 0, totalTime: 0 };
                    return stats;
                } catch (e) {
                    console.error("Failed to load stats:", e);
                    return { totalSessions: 0, totalWords: 0, totalTime: 0 };
                }
            }

            // çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜ã™ã‚‹
            saveStats() {
                try {
                    localStorage.setItem('voiceAssistantStats', JSON.stringify(this.stats));
                } catch (e) {
                    console.error("Failed to save stats:", e);
                    this.updateStatus('çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãŒã„ã£ã±ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚', 'error');
                }
            }

            // å±¥æ­´ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰èª­ã¿è¾¼ã‚€
            loadHistory() {
                try {
                    const history = JSON.parse(localStorage.getItem('voiceAssistantHistory')) || [];
                    return history;
                } catch (e) {
                    console.error("Failed to load history:", e);
                    return [];
                }
            }

            // å±¥æ­´ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜ã™ã‚‹
            saveHistory() {
                try {
                    localStorage.setItem('voiceAssistantHistory', JSON.stringify(this.history));
                } catch (e) {
                    console.error("Failed to save history:", e);
                    this.updateStatus('å±¥æ­´ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãŒã„ã£ã±ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚', 'error');
                }
            }

            // å±¥æ­´ãƒªã‚¹ãƒˆã‚’è¡¨ç¤ºã«åæ˜ 
            loadHistoryDisplay() {
                this.historyList.innerHTML = ''; // æ—¢å­˜ã®ãƒªã‚¹ãƒˆã‚’ã‚¯ãƒªã‚¢
                if (this.history.length === 0) {
                    this.historyList.innerHTML = '<p style="text-align: center; color: #999;">ã¾ã å±¥æ­´ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>';
                    return;
                }
                this.history.forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'history-item';
                    // XSSå¯¾ç­–: textContentã‚’ä½¿ç”¨
                    div.innerHTML = `
                        <div class="history-item-date">${item.date}</div>
                        <div class="history-item-text"></div>
                    `;
                    div.querySelector('.history-item-text').textContent = item.text;
                    
                    // å±¥æ­´ã‚¢ã‚¤ãƒ†ãƒ ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã«å†…å®¹ã‚’ãƒ­ãƒ¼ãƒ‰
                    div.addEventListener('click', () => {
                        this.textOutput.value = item.text;
                        this.updateCharCount();
                        this.updateStatus('å±¥æ­´ã‚’ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸ');
                    });
                    this.historyList.appendChild(div);
                });
            }

            // ãƒã‚¤ã‚¯è¨±å¯ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€å¿…è¦ã«å¿œã˜ã¦ã‚¬ã‚¤ãƒ‰ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤º
            async checkMicrophonePermissionAndShowGuide() {
                if (!this.showMicrophoneGuideOnStartup) {
                    return; // ã‚¬ã‚¤ãƒ‰è¡¨ç¤ºè¨­å®šãŒã‚ªãƒ•ã®å ´åˆã¯ä½•ã‚‚ã—ãªã„
                }

                try {
                    const permissionStatus = await navigator.permissions.query({ name: 'microphone' });

                    if (permissionStatus.state === 'granted') {
                        // ãƒã‚¤ã‚¯ãŒæ—¢ã«è¨±å¯ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤ºã—ãªã„
                        this.hasRequestedMicrophonePermission = true; // è¨±å¯ã•ã‚Œã¦ã„ã‚‹å ´åˆã‚‚ãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã‚‹
                        return;
                    } else if (permissionStatus.state === 'denied') {
                        // è¨±å¯ãŒæ‹’å¦ã•ã‚Œã¦ã„ã‚‹å ´åˆ
                        this.showMicrophoneGuideModal();
                    } else if (permissionStatus.state === 'prompt') {
                        // è¨±å¯ã‚’æ±‚ã‚ã‚‰ã‚Œã‚‹çŠ¶æ…‹ã®å ´åˆ
                        // ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã«ä¸€åº¦ã‚‚ãƒã‚¤ã‚¯è¨±å¯ã‚’è¦æ±‚ã—ã¦ã„ãªã‘ã‚Œã°ã€ã“ã“ã§è¦æ±‚ã™ã‚‹
                        if (!this.hasRequestedMicrophonePermission) {
                            try {
                                // recognition.start() ã‚’å‘¼ã³å‡ºã™ã“ã¨ã§ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒã‚¤ã‚¯è¨±å¯ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹
                                // ãŸã ã—ã€ã“ã“ã§ã¯å®Ÿéš›ã«éŒ²éŸ³ã‚’é–‹å§‹ã›ãšã€è¨±å¯ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ãƒˆãƒªã‚¬ãƒ¼ã®ã¿ã‚’ç›®çš„ã¨ã™ã‚‹
                                // ãã®ãŸã‚ã€ã™ãã« recognition.abort() ã‚’å‘¼ã³å‡ºã™
                                this.recognition.start();
                                this.recognition.abort(); // è¨±å¯ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¡¨ç¤ºå¾Œã™ãã«åœæ­¢
                            } catch (e) {
                                console.warn("Failed to trigger microphone permission prompt:", e);
                                // ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã‚‚ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚¬ã‚¤ãƒ‰ã‚’è¡¨ç¤ºã™ã‚‹
                                this.showMicrophoneGuideModal();
                            }
                            this.hasRequestedMicrophonePermission = true; // è¦æ±‚ãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã‚‹
                        }
                    }
                } catch (error) {
                    console.error('ãƒã‚¤ã‚¯è¨±å¯ã®ç¢ºèªä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
                    // ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã‚‚ã‚¬ã‚¤ãƒ‰ã‚’è¡¨ç¤ºã™ã‚‹
                    this.showMicrophoneGuideModal();
                }
            }

            // ãƒã‚¤ã‚¯ã‚¬ã‚¤ãƒ‰ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤º
            showMicrophoneGuideModal() {
                this.microphoneGuideModal.classList.add('active');
            }

            // ãƒã‚¤ã‚¯ã‚¬ã‚¤ãƒ‰ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’éè¡¨ç¤º
            hideMicrophoneGuideModal() {
                this.microphoneGuideModal.classList.remove('active');
            }

            // ãƒã‚¤ã‚¯ã‚¬ã‚¤ãƒ‰è¡¨ç¤ºè¨­å®šã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
            saveMicrophoneGuideSetting() {
                try {
                    localStorage.setItem('showMicrophoneGuide', JSON.stringify(this.showMicrophoneGuideOnStartup));
                } catch (e) {
                    console.error("Failed to save microphone guide setting:", e);
                    this.updateStatus('ãƒã‚¤ã‚¯ã‚¬ã‚¤ãƒ‰è¨­å®šã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸã€‚', 'error');
                }
            }

            // ãƒã‚¤ã‚¯ã‚¬ã‚¤ãƒ‰è¡¨ç¤ºè¨­å®šã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰ãƒ­ãƒ¼ãƒ‰
            loadMicrophoneGuideSetting() {
                try {
                    const setting = localStorage.getItem('showMicrophoneGuide');
                    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯trueï¼ˆè¡¨ç¤ºã™ã‚‹ï¼‰
                    return setting === null ? true : JSON.parse(setting);
                } catch (e) {
                    console.error("Failed to load microphone guide setting:", e);
                    return true; // ã‚¨ãƒ©ãƒ¼æ™‚ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§è¡¨ç¤ºã™ã‚‹
                }
            }

            // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å½¢å¼è¨­å®šã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰ãƒ­ãƒ¼ãƒ‰
            loadDownloadFormatSettings() {
                try {
                    const settings = JSON.parse(localStorage.getItem('downloadFormatSettings')) || {};
                    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯txtã®ã¿true
                    if (Object.keys(settings).length === 0) {
                        return { txt: true, md: false, html: false, json: false, csv: false };
                    }
                    return settings;
                } catch (e) {
                    console.error("Failed to load download format settings:", e);
                    return { txt: true, md: false, html: false, json: false, csv: false };
                }
            }

            // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å½¢å¼è¨­å®šã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
            saveDownloadFormatSettings() {
                const settings = {};
                this.downloadFormatCheckboxes.forEach(checkbox => {
                    settings[checkbox.value] = checkbox.checked;
                });
                try {
                    localStorage.setItem('downloadFormatSettings', JSON.stringify(settings));
                } catch (e) {
                    console.error("Failed to save download format settings:", e);
                    this.updateStatus('ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å½¢å¼è¨­å®šã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸã€‚', 'error');
                }
            }

            // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å½¢å¼è¨­å®šã‚’UIã«é©ç”¨
            applyDownloadFormatSettings() {
                this.downloadFormatCheckboxes.forEach(checkbox => {
                    checkbox.checked = this.downloadFormats[checkbox.value] || false;
                });
            }

            // OpenAI APIã‚­ãƒ¼ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰ãƒ­ãƒ¼ãƒ‰
            loadOpenAIApiKey() {
                try {
                    return localStorage.getItem('openaiApiKey') || '';
                } catch (e) {
                    console.error("Failed to load OpenAI API key:", e);
                    return '';
                }
            }

            // OpenAI APIã‚­ãƒ¼ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
            saveOpenAIApiKey(key) {
                try {
                    localStorage.setItem('openaiApiKey', key);
                } catch (e) {
                    console.error("Failed to save OpenAI API key:", e);
                    this.updateStatus('APIã‚­ãƒ¼ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãŒã„ã£ã±ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚', 'error');
                }
            }

            // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºã‚’æ›´æ–°ã™ã‚‹æ±ç”¨ãƒ¡ã‚½ãƒƒãƒ‰
            updateStatus(message, type = 'info', duration = 3000) {
                this.statusDisplay.textContent = message;
                this.statusDisplay.className = `status-display ${type === 'error' ? 'error' : type === 'listening' ? 'listening' : ''}`;

                // ä¸€æ™‚çš„ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å ´åˆã€ä¸€å®šæ™‚é–“å¾Œã«ãƒªã‚»ãƒƒãƒˆ
                if (duration > 0 && type !== 'listening') {
                    clearTimeout(this.statusTimeout); // æ—¢å­˜ã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆãŒã‚ã‚Œã°ã‚¯ãƒªã‚¢
                    this.statusTimeout = setTimeout(() => {
                        this.statusDisplay.textContent = 'æº–å‚™å®Œäº† - ãƒã‚¤ã‚¯ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦é–‹å§‹';
                        this.statusDisplay.className = 'status-display';
                    }, duration);
                }
            }

            // ãƒ†ã‚­ã‚¹ãƒˆã‚’è¦ç´„ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰
            async summarizeText() {
                const originalText = this.textOutput.value.trim();
                if (!originalText) {
                    this.updateStatus("è¦ç´„ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆãŒã‚ã‚Šã¾ã›ã‚“", "error");
                    return;
                }

                if (!this.openaiApiKey) {
                    this.updateStatus("OpenAI APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚è¨­å®šãƒ‘ãƒãƒ«ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚", "error");
                    return;
                }

                this.updateStatus("è¦ç´„ä¸­...", "listening");

                try {
                    const response = await fetch("https://api.openai.com/v1/chat/completions", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                            "Authorization": `Bearer ${this.openaiApiKey}`
                        },
                        body: JSON.stringify({
                            model: "gpt-3.5-turbo",
                            messages: [
                                { role: "system", content: "ä»¥ä¸‹ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’è¦ç‚¹ã ã‘5è¡Œä»¥å†…ã§ã¾ã¨ã‚ã¦ãã ã•ã„ã€‚" },
                                { role: "user", content: originalText }
                            ],
                            temperature: 0.5
                        })
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error?.message || `APIã‚¨ãƒ©ãƒ¼: ${response.status} ${response.statusText}`);
                    }

                    const data = await response.json();
                    const summary = data.choices?.[0]?.message?.content?.trim();
                    if (summary) {
                        this.saveToUndoStack(); // è¦ç´„è¿½åŠ å‰ã«ã‚¢ãƒ³ãƒ‰ã‚¥ã‚¹ã‚¿ãƒƒã‚¯ã«ä¿å­˜
                        this.textOutput.value += "\n\n---\nğŸ§  è¦ç´„:\n" + summary;
                        this.updateStatus("è¦ç´„ãŒå®Œäº†ã—ã¾ã—ãŸ");
                        this.updateCharCount();
                    } else {
                        throw new Error("è¦ç´„çµæœãŒå–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸ");
                    }
                } catch (err) {
                    console.error("è¦ç´„ã‚¨ãƒ©ãƒ¼:", err);
                    this.updateStatus("è¦ç´„ã«å¤±æ•—ã—ã¾ã—ãŸ: " + err.message, "error");
                }
            }
        }

        // DOMContentLoadedã‚¤ãƒ™ãƒ³ãƒˆã§VoiceAssistantProã‚¯ãƒ©ã‚¹ã‚’åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', () => {
            new VoiceAssistantPro();
        });
    </script>
</body>
</html>
```
0.1ç§’
ä¸ŠçŸ¢å°ã‚­ãƒ¼ã¨ä¸‹çŸ¢å°ã‚­ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ã‚¿ãƒ¼ãƒ³ã‚’é¸æŠã—ã€Enter ã‚­ãƒ¼ã§ãã®ã‚¿ãƒ¼ãƒ³ã«ã‚¸ãƒ£ãƒ³ãƒ—ã—ã€Escape ã‚­ãƒ¼ã§ãƒãƒ£ãƒƒãƒˆã«æˆ»ã‚Šã¾ã™ã€‚
ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å…¥åŠ›ã—å§‹ã‚ã‚‹å¼.htmlâ€¦]()

---

---

## 2. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰ (Claude Voice Assistant Proãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰.md)
[Claude Voice Assistant Pro_ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰.md](https://github.com/user-attachments/files/22306285/Claude.Voice.Assistant.Pro_.md)
## 1. GitHubç”¨ README.md (åˆå¿ƒè€…å‘ã‘ãƒãƒ‹ãƒ¥ã‚¢ãƒ«)

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€GitHubã«å…¬é–‹ã™ã‚‹éš›ã«åˆ©ç”¨ã§ãã‚‹å½¢å¼ã§ä½œæˆã—ã¦ã„ã¾ã™ã€‚
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ¦‚è¦ã€ä½¿ã„æ–¹ã€ä¸»è¦æ©Ÿèƒ½ãªã©ã‚’åˆå¿ƒè€…ã®æ–¹ã«ã‚‚åˆ†ã‹ã‚Šã‚„ã™ãèª¬æ˜ã—ã¾ã™ã€‚

---

# Claude Voice Assistant Pro ğŸ¤

Claude Voice Assistant Pro ã¯ã€ã‚ãªãŸã®å£°ã‚’ãƒ†ã‚­ã‚¹ãƒˆã«å¤‰æ›ã—ã€AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã€ŒClaudeã€ã¨ã®å¯¾è©±ã‚’ã‚ˆã‚Šã‚¹ãƒ ãƒ¼ã‚ºã«ã™ã‚‹ãŸã‚ã®é©æ–°çš„ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚ç›´æ„Ÿçš„ãªãƒœã‚¿ãƒ³æ“ä½œã§ã€è©±ã™ã ã‘ã§ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ãŒå¯èƒ½ã«ãªã‚Šã€Claudeã®æ´»ç”¨ã‚’æœ€å¤§åŒ–ã§ãã¾ã™ã€‚

## âœ¨ ä¸»ãªæ©Ÿèƒ½ - ãƒœã‚¿ãƒ³ã§ç›´æ„Ÿçš„ã«æ“ä½œï¼

ã“ã®ã‚¢ãƒ—ãƒªã¯ã€è¦–è¦šçš„ã«åˆ†ã‹ã‚Šã‚„ã™ã„ãƒœã‚¿ãƒ³ã‚’ä½¿ã£ã¦ã€èª°ã§ã‚‚ç°¡å˜ã«æ“ä½œã§ãã¾ã™ã€‚

*   **ğŸ¤ éŸ³å£°å…¥åŠ›ã®é–‹å§‹/åœæ­¢:** ãƒã‚¤ã‚¯ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã ã‘ã§ã€ã‚ãªãŸã®å£°ãŒç¬æ™‚ã«ãƒ†ã‚­ã‚¹ãƒˆã«å¤‰æ›ã•ã‚Œå§‹ã‚ã¾ã™ã€‚ã‚‚ã†ä¸€åº¦æŠ¼ã™ã‹ã€â¹ï¸ãƒœã‚¿ãƒ³ã§åœæ­¢ã—ã¾ã™ã€‚
*   **ğŸ“‹ ãƒ†ã‚­ã‚¹ãƒˆã®ã‚³ãƒ”ãƒ¼:** ç”Ÿæˆã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆã‚’ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã§ãã¾ã™ã€‚
*   **ğŸ—‘ï¸ ãƒ†ã‚­ã‚¹ãƒˆã®ã‚¯ãƒªã‚¢:** ç¾åœ¨ã®ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã®å†…å®¹ã‚’ç°¡å˜ã«æ¶ˆå»ã§ãã¾ã™ã€‚
*   **ğŸ’¾ å±¥æ­´ã¸ã®ä¿å­˜:** é‡è¦ãªä¼šè©±ã‚„ãƒ¡ãƒ¢ã¯ã€ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§å±¥æ­´ã¨ã—ã¦ä¿å­˜ã§ãã¾ã™ã€‚å¾Œã§ã„ã¤ã§ã‚‚è¦‹è¿”ã—ãŸã‚Šã€å†åˆ©ç”¨ã—ãŸã‚Šã§ãã¾ã™ã€‚
*   **â¬‡ï¸ ãƒ†ã‚­ã‚¹ãƒˆã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰:**
    *   ç¾åœ¨ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’æ§˜ã€…ãªå½¢å¼ï¼ˆ`.txt`, `.md`, `.html`, `.json`, `.csv`ï¼‰ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚
    *   ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€**ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ«ãƒ€**ã«è‡ªå‹•çš„ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚
*   **ğŸ§  AIè¦ç´„æ©Ÿèƒ½ (NEW!):**
    *   å…¥åŠ›ã—ãŸãƒ†ã‚­ã‚¹ãƒˆã‚’AIï¼ˆOpenAIï¼‰ãŒ**è‡ªå‹•ã§è¦ç´„**ã—ã¦ãã‚Œã¾ã™ã€‚é•·ã„æ–‡ç« ã‚‚ã™ãã«ãƒã‚¤ãƒ³ãƒˆã‚’æŠŠæ¡ã§ãã¾ã™ï¼
    *   _â€» ã“ã®æ©Ÿèƒ½ã‚’åˆ©ç”¨ã™ã‚‹ã«ã¯ã€ã‚³ãƒ¼ãƒ‰å†…ã«ã”è‡ªèº«ã®OpenAI APIã‚­ãƒ¼ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚_
*   **â†¶ å…ƒã«æˆ»ã™ / â†· ã‚„ã‚Šç›´ã—:** å…¥åŠ›ãƒŸã‚¹ã‚„å¤‰æ›´ã‚‚ã€ãƒœã‚¿ãƒ³ä¸€ã¤ã§ç°¡å˜ã«å–ã‚Šæ¶ˆã—ãŸã‚Šã€å…ƒã«æˆ»ã—ãŸã‚Šã§ãã¾ã™ã€‚
*   **ğŸ‡¯ğŸ‡µ è¨€èªé¸æŠ:** æ—¥æœ¬èªã ã‘ã§ãªãã€è‹±èªãªã©è¤‡æ•°ã®è¨€èªã§ã®éŸ³å£°èªè­˜ã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚
*   **ğŸ“ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ:** ã‚ˆãä½¿ã†ãƒ•ãƒ¬ãƒ¼ã‚ºã‚„è³ªå•ã‚’ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨ã—ã¦ç”¨æ„ã€‚ã‚¯ãƒªãƒƒã‚¯ä¸€ã¤ã§ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã«æŒ¿å…¥ã—ã€Claudeã¸ã®æŒ‡ç¤ºã‚’åŠ¹ç‡åŒ–ã§ãã¾ã™ã€‚
*   **ğŸ“š å±¥æ­´è¡¨ç¤º:** éå»ã®éŸ³å£°å…¥åŠ›å†…å®¹ã‚’ä¸€è¦§ã§ç¢ºèªã—ã€ã‚¯ãƒªãƒƒã‚¯ã§å†ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚
*   **ğŸ“Š åˆ©ç”¨çµ±è¨ˆ:** ã‚»ãƒƒã‚·ãƒ§ãƒ³æ•°ã€ç·å˜èªæ•°ã€ç·åˆ©ç”¨æ™‚é–“ãªã©ã€ã‚ãªãŸã®Claudeæ´»ç”¨çŠ¶æ³ã‚’æ•°å€¤ã§ç¢ºèªã§ãã¾ã™ã€‚

## ğŸš€ ä½¿ã„æ–¹ - ãŸã£ãŸã“ã‚Œã ã‘ï¼

1.  **ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ã:**
    `ClaudeVoicepro_with_Summary.html` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¦ã‚§ãƒ–ãƒ–ãƒ©ã‚¦ã‚¶ï¼ˆGoogle Chrome, Microsoft Edgeãªã©ï¼‰ã§é–‹ãã¾ã™ã€‚
    *   _ãƒ’ãƒ³ãƒˆ: ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¢ã‚¤ã‚³ãƒ³ã«ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã™ã‚‹ã‹ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å³ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‹ã‚‰é–‹ãã€â†’ã€Œã‚¦ã‚§ãƒ–ãƒ–ãƒ©ã‚¦ã‚¶ã€ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚_
2.  **ãƒã‚¤ã‚¯ã®è¨±å¯:**
    åˆã‚ã¦åˆ©ç”¨ã™ã‚‹éš›ã€ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ãƒã‚¤ã‚¯ã®ä½¿ç”¨è¨±å¯ã‚’æ±‚ã‚ã‚‰ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ã€Œè¨±å¯ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚
    *   _ã‚‚ã—ã€Œè¨±å¯ã€ãŒå‡ºãªã„å ´åˆã‚„ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹å ´åˆã¯ã€ç”»é¢å³ä¸Šã®ã€Œè¨­å®šã€ãƒ‘ãƒãƒ«å†…ã«ã‚ã‚‹ã€Œãƒã‚¤ã‚¯è¨­å®šã‚¬ã‚¤ãƒ‰ã‚’è¡¨ç¤ºã€ã‚’ã”ç¢ºèªãã ã•ã„ã€‚_
3.  **éŸ³å£°å…¥åŠ›ã®é–‹å§‹:**
    ç”»é¢ä¸­å¤®ã«ã‚ã‚‹å¤§ããªãƒã‚¤ã‚¯ãƒœã‚¿ãƒ³ï¼ˆğŸ¤ï¼‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºãŒã€Œèã„ã¦ã„ã¾ã™... è©±ã—ã¦ãã ã•ã„ã€ã«å¤‰ã‚ã£ãŸã‚‰ã€è©±ã—å§‹ã‚ã¦ãã ã•ã„ã€‚
4.  **ãƒ†ã‚­ã‚¹ãƒˆã®ç¢ºèª:**
    è©±ã—ãŸå†…å®¹ãŒãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
5.  **æ“ä½œã®å®Ÿè¡Œ:**
    å¿…è¦ã«å¿œã˜ã¦ã€ã‚³ãƒ”ãƒ¼ï¼ˆğŸ“‹ï¼‰ã€ã‚¯ãƒªã‚¢ï¼ˆğŸ—‘ï¸ï¼‰ã€ä¿å­˜ï¼ˆğŸ’¾ï¼‰ã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆâ¬‡ï¸ï¼‰ã€AIè¦ç´„ï¼ˆğŸ§ ï¼‰ãªã©ã®ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦æ“ä½œã—ã¾ã™ã€‚
6.  **ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®æ´»ç”¨:**
    å³å´ã®ã€Œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã€ãƒ‘ãƒãƒ«ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã«ä¾¿åˆ©ãªãƒ•ãƒ¬ãƒ¼ã‚ºãŒæŒ¿å…¥ã•ã‚Œã¾ã™ã€‚

## ğŸ’¡ é‡è¦äº‹é …

*   **OpenAI APIã‚­ãƒ¼ã®è¨­å®šã«ã¤ã„ã¦:**
    AIè¦ç´„æ©Ÿèƒ½ã‚’åˆ©ç”¨ã™ã‚‹ã«ã¯ã€JavaScriptã‚³ãƒ¼ãƒ‰å†…ã®ä»¥ä¸‹ã®è¡Œã‚’ã€ã”è‡ªèº«ã®OpenAI APIã‚­ãƒ¼ã«ç½®ãæ›ãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
    `const OPENAI_API_KEY = "YOUR_API_KEY_HERE";`
    _ã“ã®ã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„å ´åˆã€è¦ç´„æ©Ÿèƒ½ã¯å‹•ä½œã—ã¾ã›ã‚“ã€‚_
    APIã‚­ãƒ¼ã¯ä»–äººã«çŸ¥ã‚‰ã‚Œãªã„ã‚ˆã†ã€æ…é‡ã«ç®¡ç†ã—ã¦ãã ã•ã„ã€‚
*   **ãƒã‚¤ã‚¯ã®ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯:**
    æœ¬ã‚¢ãƒ—ãƒªã¯Web Speech APIã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã€ãƒ–ãƒ©ã‚¦ã‚¶ã‚„OSã®ãƒã‚¤ã‚¯ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ãŒå¿…è¦ã§ã™ã€‚åˆå›èµ·å‹•æ™‚ã«ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã®ã§ã€ã€Œè¨±å¯ã€ã—ã¦ãã ã•ã„ã€‚
*   **ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦å‹•ä½œ:**
    ã“ã®ã‚¢ãƒ—ãƒªã¯HTMLãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šãŒãªãã¦ã‚‚éŸ³å£°èªè­˜æ©Ÿèƒ½ï¼ˆOpenAIè¦ç´„æ©Ÿèƒ½ã‚’é™¤ãï¼‰ã¯å‹•ä½œã—ã¾ã™ã€‚

---

## ğŸ’» å‹•ä½œç’°å¢ƒ

*   æœ€æ–°ã®Webãƒ–ãƒ©ã‚¦ã‚¶ (Google Chrome, Microsoft Edge, Firefoxãªã©)
*   ãƒã‚¤ã‚¯ãƒ‡ãƒã‚¤ã‚¹
*   OpenAIè¦ç´„æ©Ÿèƒ½ã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã¨OpenAI APIã‚­ãƒ¼

---

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

---

### MITãƒ©ã‚¤ã‚»ãƒ³ã‚¹

è‘—ä½œæ¨©è¡¨ç¤º

Copyright (c) 2025 Hanamaruki

ã“ã“ã«ã€æœ¬ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¨ãã‚Œã«é–¢é€£ã™ã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆä»¥ä¸‹ã€Œæœ¬ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã€ï¼‰ã®è¤‡è£½ç‰©ã‚’å—ã‘å–ã‚‹ã™ã¹ã¦ã®äººã«å¯¾ã—ã€ç„¡æ–™ã§åˆ©ç”¨ã‚’è¨±å¯ã—ã¾ã™ã€‚
ã“ã®è¨±å¯ã«ã¯ã€æœ¬ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’åˆ¶é™ãªãå–ã‚Šæ‰±ã†æ¨©åˆ©ãŒå«ã¾ã‚Œã¾ã™ã€‚
å…·ä½“çš„ã«ã¯ã€ä½¿ç”¨ã€è¤‡è£½ã€å¤‰æ›´ã€çµåˆã€å‡ºç‰ˆã€é…å¸ƒã€ã‚µãƒ–ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ä»˜ä¸ã€ãŠã‚ˆã³è²©å£²ã‚’è¡Œã†æ¨©åˆ©ã€ã¾ãŸã€æœ¬ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãŒæä¾›ã•ã‚Œã‚‹ç›¸æ‰‹ã«å¯¾ã—ã¦ã€ã“ã‚Œã‚‰ã®è¡Œç‚ºã‚’è¨±å¯ã™ã‚‹æ¨©åˆ©ã‚’æ„å‘³ã—ã¾ã™ã€‚
ãŸã ã—ã€ä»¥ä¸‹ã®æ¡ä»¶ã«å¾“ã†ã‚‚ã®ã¨ã—ã¾ã™ã€‚

ä¸Šè¨˜ã«è¨˜è¼‰ã•ã‚ŒãŸè‘—ä½œæ¨©è¡¨ç¤ºã¨ã€æœ¬è¨±å¯è¡¨ç¤ºã¯ã€æœ¬ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ã™ã¹ã¦ã®è¤‡è£½ç‰©ã€ã¾ãŸã¯å®Ÿè³ªçš„ãªéƒ¨åˆ†ã«å«ã¾ã‚Œãªã‘ã‚Œã°ãªã‚‰ãªã„ã‚‚ã®ã¨ã—ã¾ã™ã€‚

æœ¬ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¯ã€Œç¾çŠ¶ã®ã¾ã¾ã€æä¾›ã•ã‚Œã€å•†å“æ€§ã€ç‰¹å®šã®ç›®çš„ã¸ã®é©åˆæ€§ã€ãŠã‚ˆã³éä¾µå®³æ€§ã«å¯¾ã™ã‚‹ä¿è¨¼ã‚’å«ã‚€ã€æ˜ç¤ºçš„ã¾ãŸã¯é»™ç¤ºçš„ãªã„ã‹ãªã‚‹ç¨®é¡ã®ä¿è¨¼ã‚‚ã‚ã‚Šã¾ã›ã‚“ã€‚
ã„ã‹ãªã‚‹å ´åˆã‚‚ã€è‘—è€…ã¾ãŸã¯è‘—ä½œæ¨©è€…ã¯ã€æœ¬ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ä½¿ç”¨ã¾ãŸã¯ãã®ä»–ã®å–ã‚Šæ‰±ã„ã‹ã‚‰ç”Ÿã˜ã‚‹ã€å¥‘ç´„ã€ä¸æ³•è¡Œç‚ºã€ã¾ãŸã¯ãã®ä»–ã®è¡Œç‚ºã«ã‹ã‹ã‚ã‚‰ãšã€ã„ã‹ãªã‚‹è«‹æ±‚ã€æå®³ã€ã¾ãŸã¯ãã®ä»–ã®è²¬ä»»ã«å¯¾ã—ã¦ã‚‚è²¬ä»»ã‚’è² ã‚ãªã„ã‚‚ã®ã¨ã—ã¾ã™ã€‚

---

### MIT License

Copyright (c) 2025 Hanamaruki

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

---

## 3. æŠ€è¡“ä»•æ§˜æ›¸ (Claude Voice Assistant Pro - æŠ€è¡“ä»•æ§˜æ›¸.md)
[ClaudeVoicePro_with_Summary.html](https://github.com/user-attachments/files/22306287/ClaudeVoicePro_with_Summary.html)
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claude Voice Assistant Pro</title>
    <style>
        /* å…¨ä½“çš„ãªãƒªã‚»ãƒƒãƒˆã¨åŸºæœ¬è¨­å®š */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }
        
        /* ã‚³ãƒ³ãƒ†ãƒŠ */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* ãƒ˜ãƒƒãƒ€ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }
        
        .header p {
            color: #666;
            font-size: 1.1em;
        }
        
        /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        /* éŸ³å£°ãƒ‘ãƒãƒ« */
        .voice-panel {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        /* éŸ³å£°ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒœã‚¿ãƒ³ç¾¤ */
        .voice-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .voice-btn {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            font-size: 28px;
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .voice-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }
        
        /* ãƒã‚¤ã‚¯ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .mic-btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
        }
        
        .mic-btn.listening {
            background: linear-gradient(45deg, #f44336, #da190b);
            animation: pulse 1.5s infinite;
        }
        
        /* ãã®ä»–ã®ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .stop-btn {
            background: linear-gradient(45deg, #f44336, #da190b);
            color: white;
        }
        
        .copy-btn {
            background: linear-gradient(45deg, #2196F3, #1976D2);
            color: white;
        }
        
        .clear-btn {
            background: linear-gradient(45deg, #ff9800, #f57c00);
            color: white;
        }
        
        .save-btn {
            background: linear-gradient(45deg, #9c27b0, #7b1fa2);
            color: white;
        }

        /* ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .download-btn {
            background: linear-gradient(45deg, #42a5f5, #1e88e5); /* é’ç³»ã®ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ */
            color: white;
        }
        
        .voice-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }
        
        /* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º */
        .status-display {
            background: linear-gradient(45deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
            color: #495057;
        }
        
        .status-display.listening {
            background: linear-gradient(45deg, #d4edda, #c3e6cb);
            color: #155724;
            border: 2px solid #28a745;
        }
        
        .status-display.error {
            background: linear-gradient(45deg, #f8d7da, #f5c6cb);
            color: #721c24;
            border: 2px solid #dc3545;
        }
        
        /* ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã‚³ãƒ³ãƒ†ãƒŠ */
        .textarea-container {
            position: relative;
        }
        
        textarea {
            width: 100%;
            height: 300px;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            font-size: 16px;
            line-height: 1.6;
            resize: vertical;
            font-family: inherit;
            background: #fafafa;
            transition: all 0.3s ease;
        }
        
        textarea:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        /* ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ãƒ„ãƒ¼ãƒ«ãƒœã‚¿ãƒ³ */
        .textarea-tools {
            position: absolute;
            bottom: 10px;
            right: 10px;
            display: flex;
            gap: 10px;
        }
        
        .tool-btn {
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 20px;
            padding: 8px 12px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }
        
        .tool-btn:hover {
            background: white;
            transform: translateY(-1px);
        }
        
        /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        /* è¨­å®šãƒ‘ãƒãƒ«ï¼ˆdetailsè¦ç´ ã¨ã—ã¦å†å®šç¾©ï¼‰ */
        .settings-panel details {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .settings-panel summary {
            font-size: 1.5em; /* h3ã®ã‚µã‚¤ã‚ºã«åˆã‚ã›ã‚‹ */
            font-weight: bold;
            color: #333;
            cursor: pointer;
            margin-bottom: 15px;
            list-style: none; /* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒãƒ¼ã‚«ãƒ¼ã‚’éè¡¨ç¤ºã« */
            display: flex;
            align-items: center;
        }

        .settings-panel summary::before {
            content: 'âš™ï¸ '; /* æ­¯è»Šã‚¢ã‚¤ã‚³ãƒ³ */
            margin-right: 10px;
        }

        .settings-panel details[open] summary {
            margin-bottom: 20px; /* é–‹ã„ãŸã¨ãã«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¨ã®é–“ã«ã‚¹ãƒšãƒ¼ã‚¹ */
        }
        
        .setting-item {
            margin-bottom: 15px;
        }
        
        .setting-item label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #555;
        }
        
        .setting-item select,
        .setting-item input[type="checkbox"] {
            width: auto; /* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®å¹…ã‚’è‡ªå‹•èª¿æ•´ */
            margin-right: 8px; /* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã¨ãƒ©ãƒ™ãƒ«ã®é–“ã«ã‚¹ãƒšãƒ¼ã‚¹ */
        }

        .setting-item input[type="text"],
        .setting-item select {
            width: 100%;
            padding: 8px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }
        
        .setting-item select:focus,
        .setting-item input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }

        .setting-item.checkbox-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .setting-item.checkbox-item label {
            margin-bottom: 0;
        }

        /* ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼é¸æŠã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .download-format-options {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 10px;
        }
        .download-format-options label {
            display: flex;
            align-items: center;
            margin-bottom: 0; /* è¦ªè¦ç´ ã®margin-bottomãŒã‚ã‚‹ã®ã§ãƒªã‚»ãƒƒãƒˆ */
            font-weight: normal;
        }
        .download-format-options input[type="checkbox"] {
            margin-right: 8px;
        }

        /* ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .reset-button {
            background: linear-gradient(45deg, #ef5350, #d32f2f); /* èµ¤ç³»ã®ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ */
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 15px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
            width: 100%;
            margin-top: 10px;
        }
        .reset-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .reset-group {
            margin-top: 20px;
            border-top: 1px solid #eee;
            padding-top: 15px;
        }
        
        /* ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ‘ãƒãƒ« */
        .templates-panel {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .template-item {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .template-item:hover {
            background: #e9ecef;
            transform: translateY(-1px);
        }
        
        .template-item h4 {
            margin-bottom: 5px;
            color: #333;
            font-size: 14px;
        }
        
        .template-item p {
            font-size: 12px;
            color: #666;
            margin: 0;
        }
        
        /* å±¥æ­´ãƒ‘ãƒãƒ« */
        .history-panel {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            max-height: 300px; /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ã«ã™ã‚‹ */
            overflow-y: auto;
        }
        
        .history-item {
            background: #f8f9fa;
            border: 1px solid #e9ecef; /* å±¥æ­´ã‚¢ã‚¤ãƒ†ãƒ ã®ãƒœãƒ¼ãƒ€ãƒ¼ã‚’è¿½åŠ  */
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 4px solid #667eea;
        }
        
        .history-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }
        
        .history-item-date {
            font-size: 11px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .history-item-text {
            font-size: 13px;
            color: #333;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap; /* 1è¡Œã§è¡¨ç¤º */
        }
        
        /* çµ±è¨ˆãƒ‘ãƒãƒ« */
        .stats-panel {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-radius: 20px;
            padding: 20px;
            color: white;
            text-align: center;
        }
        
        .stats-item {
            margin-bottom: 15px;
        }
        
        .stats-number {
            font-size: 2em;
            font-weight: bold;
            display: block;
        }
        
        .stats-label {
            font-size: 0.9em;
            opacity: 0.8;
        }
        
        /* æ–‡å­—æ•°ãƒ»å˜èªæ•°è¡¨ç¤º */
        .word-count {
            text-align: right;
            color: #666;
            margin-top: 10px;
            font-size: 14px;
        }
        
        /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ */
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr; /* 1åˆ—ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã«å¤‰æ›´ */
            }
            
            .voice-controls {
                gap: 10px;
            }
            
            .voice-btn {
                width: 60px;
                height: 60px;
                font-size: 24px;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }

        /* ãƒã‚¤ã‚¯ã‚¬ã‚¤ãƒ‰ãƒ¢ãƒ¼ãƒ€ãƒ« */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            max-width: 500px;
            text-align: center;
            transform: translateY(-20px);
            transition: transform 0.3s ease;
        }

        .modal-overlay.active .modal-content {
            transform: translateY(0);
        }

        .modal-content h3 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .modal-content p {
            margin-bottom: 15px;
            line-height: 1.6;
            color: #555;
        }

        .modal-content ul {
            list-style: none;
            padding: 0;
            margin-bottom: 20px;
            text-align: left;
            color: #666;
        }

        .modal-content ul li {
            margin-bottom: 10px;
            padding-left: 0; /* ãƒã‚§ãƒƒã‚¯ãƒãƒ¼ã‚¯ã‚’å‰Šé™¤ã—ãŸã®ã§ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚‚ä¸è¦ */
            position: relative;
        }

        /* ãƒã‚§ãƒƒã‚¯ãƒãƒ¼ã‚¯ã‚’å‰Šé™¤ */
        .modal-content ul li::before {
            content: none; 
        }

        .modal-close-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 25px;
            padding: 12px 25px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1em;
        }

        .modal-close-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¤ Claude Voice Assistant Pro</h1>
            <p>éŸ³å£°å…¥åŠ›ã§Claudeæ´»ç”¨ã‚’æœ€å¤§åŒ–ï¼ãƒ—ãƒ­ä»•æ§˜ã®éŸ³å£°èªè­˜ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ</p>
        </div>
        
        <div class="main-content">
            <div class="voice-panel">
                <div class="status-display" id="statusDisplay">
                    æº–å‚™å®Œäº† - ãƒã‚¤ã‚¯ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦é–‹å§‹
                </div>
                
                <div class="voice-controls">
                    <button class="voice-btn mic-btn" id="micBtn" title="éŸ³å£°å…¥åŠ›é–‹å§‹">
                        ğŸ¤
                    </button>
                    <button class="voice-btn stop-btn" id="stopBtn" title="éŒ²éŸ³åœæ­¢" disabled>
                        â¹ï¸
                    </button>
                    <button class="voice-btn copy-btn" id="copyBtn" title="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼">
                        ğŸ“‹
                    </button>
                    <button class="voice-btn clear-btn" id="clearBtn" title="ãƒ†ã‚­ã‚¹ãƒˆã‚¯ãƒªã‚¢">
                        ğŸ—‘ï¸
                    </button>
                    <button class="voice-btn save-btn" id="saveBtn" title="å±¥æ­´ã«ä¿å­˜">
                        ğŸ’¾
                    </button>
                    <button class="voice-btn download-btn" id="downloadBtn" title="ãƒ†ã‚­ã‚¹ãƒˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰">
                        â¬‡ï¸
                    </button>
                </div>
                
                <div class="textarea-container">
                    <textarea id="textOutput" placeholder="éŸ³å£°ã§å…¥åŠ›ã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

ğŸ¯ Claudeæ´»ç”¨ã®ã‚³ãƒ„ï¼š
â€¢ ã€Œã€œã«ã¤ã„ã¦è©³ã—ãæ•™ãˆã¦ã€
â€¢ ã€Œã€œã‚’åˆ†ã‹ã‚Šã‚„ã™ãèª¬æ˜ã—ã¦ã€
â€¢ ã€Œã€œã®ãƒ¡ãƒªãƒƒãƒˆã¨ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã¯ï¼Ÿã€
â€¢ ã€Œã€œã‚’è¦ç´„ã—ã¦ã€

å³å´ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚‚æ´»ç”¨ã—ã¦ãã ã•ã„ï¼"></textarea>
<!-- è¦ç´„ãƒœã‚¿ãƒ³ -->
<div class="summary-container" style="text-align: right; margin-top: 10px;">
  <button id="summarizeBtn" class="tool-btn">ğŸ§  è¦ç´„ã™ã‚‹</button>
</div>

                    <div class="textarea-tools">
                        <button class="tool-btn" id="undoBtn">â†¶ å…ƒã«æˆ»ã™</button>
                        <button class="tool-btn" id="redoBtn">â†· ã‚„ã‚Šç›´ã—</button>
                    </div>
                </div>
                
                <div class="word-count">
                    æ–‡å­—æ•°: <span id="charCount">0</span> | å˜èªæ•°: <span id="wordCount">0</span>
                </div>
            </div>
            
            <div class="sidebar">
                <div class="settings-panel">
                    <details open> <!-- openå±æ€§ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§é–‹ã -->
                        <summary>è¨­å®š</summary>
                        <div class="setting-item">
                            <label for="language">è¨€èª</label>
                            <select id="language">
                                <option value="ja-JP">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
                                <option value="en-US">ğŸ‡ºğŸ‡¸ English</option>
                                <option value="en-GB">ğŸ‡¬ğŸ‡§ English (UK)</option>
                                <option value="zh-CN">ğŸ‡¨  ä¸­æ–‡</option>
                                <option value="ko-KR">ğŸ‡°ğŸ‡· í•œêµ­ì–´</option>
                            </select>
                        </div>
                        <div class="setting-item checkbox-item">
                            <label for="autoSave">è‡ªå‹•ä¿å­˜</label>
                            <input type="checkbox" id="autoSave" checked>
                        </div>
                        <div class="setting-item checkbox-item">
                            <label for="showMicrophoneGuide">ãƒã‚¤ã‚¯è¨­å®šã‚¬ã‚¤ãƒ‰ã‚’è¡¨ç¤º</label>
                            <input type="checkbox" id="showMicrophoneGuide" checked>
                        </div>
                        <div class="setting-item">
                            <label for="theme">ãƒ†ãƒ¼ãƒ</label>
                            <select id="theme">
                                <option value="default">ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ</option>
                                <option value="dark">ãƒ€ãƒ¼ã‚¯</option>
                                <option value="minimal">ãƒŸãƒ‹ãƒãƒ«</option>
                            </select>
                        </div>

                        <div class="setting-item">
                            <label>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å½¢å¼</label>
                            <div class="download-format-options" id="downloadFormatOptions">
                                <label><input type="checkbox" id="downloadFormat_txt" value="txt" data-mime-type="text/plain;charset=utf-8" data-extension="txt" checked> ğŸ“„ ãƒ†ã‚­ã‚¹ãƒˆ (.txt)</label>
                                <label><input type="checkbox" id="downloadFormat_md" value="md" data-mime-type="text/markdown;charset=utf-8" data-extension="md"> ğŸ“ ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ (.md)</label>
                                <label><input type="checkbox" id="downloadFormat_html" value="html" data-mime-type="text/html;charset=utf-8" data-extension="html"> ğŸŒ HTML (.html)</label>
                                <label><input type="checkbox" id="downloadFormat_json" value="json" data-mime-type="application/json;charset=utf-8" data-extension="json"> ğŸ’» JSON (.json)</label>
                                <label><input type="checkbox" id="downloadFormat_csv" value="csv" data-mime-type="text/csv;charset=utf-8" data-extension="csv"> ğŸ“Š CSV (.csv)</label>
                            </div>
                        </div>

                        <div class="reset-group">
                            <button class="reset-button" id="resetHistoryBtn">ğŸ“š å±¥æ­´ã‚’ãƒªã‚»ãƒƒãƒˆ</button>
                            <button class="reset-button" id="resetStatsBtn">ğŸ“Š çµ±è¨ˆã‚’ãƒªã‚»ãƒƒãƒˆ</button>
                        </div>
                    </details>
                </div>
                
                <div class="templates-panel">
                    <h3>ğŸ“ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</h3>
                    <div class="template-item" data-template="ã«ã¤ã„ã¦è©³ã—ãæ•™ãˆã¦ãã ã•ã„ã€‚ç‰¹ã«ä»¥ä¸‹ã®ç‚¹ã‚’å«ã‚ã¦èª¬æ˜ã—ã¦ãã ã•ã„ï¼š">
                        <h4>è©³ç´°èª¬æ˜</h4>
                        <p>ãƒˆãƒ”ãƒƒã‚¯ã«ã¤ã„ã¦è©³ã—ãèª¬æ˜ã—ã¦ã‚‚ã‚‰ã†</p>
                    </div>
                    <div class="template-item" data-template="ã‚’åˆ†ã‹ã‚Šã‚„ã™ãè¦ç´„ã—ã¦ãã ã•ã„ã€‚è¦ç‚¹ã‚’ç®‡æ¡æ›¸ãã§æ•™ãˆã¦ãã ã•ã„ï¼š">
                        <h4>è¦ç´„ãƒ»æ•´ç†</h4>
                        <p>å†…å®¹ã‚’æ•´ç†ã—ã¦è¦ç´„ã—ã¦ã‚‚ã‚‰ã†</p>
                    </div>
                    <div class="template-item" data-template="ã®ãƒ¡ãƒªãƒƒãƒˆã¨ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã‚’æ•™ãˆã¦ãã ã•ã„ã€‚æ¯”è¼ƒè¡¨ãŒã‚ã‚‹ã¨åŠ©ã‹ã‚Šã¾ã™ï¼š">
                        <h4>æ¯”è¼ƒåˆ†æ</h4>
                        <p>ãƒ¡ãƒªãƒƒãƒˆãƒ»ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã‚’æ¯”è¼ƒåˆ†æ</p>
                    </div>
                    <div class="template-item" data-template="ã«ã¤ã„ã¦åˆå¿ƒè€…ã«ã‚‚åˆ†ã‹ã‚‹ã‚ˆã†ã«èª¬æ˜ã—ã¦ãã ã•ã„ã€‚å…·ä½“ä¾‹ã‚‚å«ã‚ã¦ï¼š">
                        <h4>åˆå¿ƒè€…å‘ã‘</h4>
                        <p>å°‚é–€ç”¨èªã‚’ä½¿ã‚ãšåˆ†ã‹ã‚Šã‚„ã™ãèª¬æ˜</p>
                    </div>
                </div>
                
                <div class="history-panel">
                    <h3>ğŸ“š å±¥æ­´</h3>
                    <div id="historyList">
                        <!-- å±¥æ­´ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
                    </div>
                </div>
                
                <div class="stats-panel">
                    <h3>ğŸ“Š çµ±è¨ˆ</h3>
                    <div class="stats-item">
                        <span class="stats-number" id="totalSessions">0</span>
                        <span class="stats-label">ã‚»ãƒƒã‚·ãƒ§ãƒ³æ•°</span>
                    </div>
                    <div class="stats-item">
                        <span class="stats-number" id="totalWords">0</span>
                        <span class="stats-label">ç·å˜èªæ•°</span>
                    </div>
                    <div class="stats-item">
                        <span class="stats-number" id="totalTime">0</span>
                        <span class="stats-label">ç·åˆ©ç”¨æ™‚é–“(åˆ†)</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ãƒã‚¤ã‚¯ã‚¬ã‚¤ãƒ‰ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div class="modal-overlay" id="microphoneGuideModal">
        <div class="modal-content">
            <h3>ãƒã‚¤ã‚¯è¨­å®šã®ãŠé¡˜ã„</h3>
            <p>ã“ã®ã‚¢ãƒ—ãƒªã¯éŸ³å£°å…¥åŠ›ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ãƒã‚¤ã‚¯ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ãªã„å ´åˆã€ä»¥ä¸‹ã®æ‰‹é †ã§è¨­å®šã‚’ã”ç¢ºèªãã ã•ã„ã€‚</p>
            <ul>
                <li>ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼ã«è¡¨ç¤ºã•ã‚Œã‚‹ãƒã‚¤ã‚¯ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆã¾ãŸã¯å—äº¬éŒ ã‚¢ã‚¤ã‚³ãƒ³ï¼‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚</li>
                <li>ã€Œãƒã‚¤ã‚¯ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã€ã¾ãŸã¯ã€Œã‚µã‚¤ãƒˆã®è¨­å®šã€ã§ã€ã“ã®ã‚µã‚¤ãƒˆã®ãƒã‚¤ã‚¯ä½¿ç”¨ã‚’ã€Œè¨±å¯ã€ã«è¨­å®šã—ã¦ãã ã•ã„ã€‚</li>
                <li>ã‚‚ã—ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨­å®šã§è¨±å¯ã§ããªã„å ´åˆã¯ã€ãŠä½¿ã„ã®OSï¼ˆWindows/macOS/Android/iOSï¼‰ã®ã‚·ã‚¹ãƒ†ãƒ è¨­å®šã§ãƒ–ãƒ©ã‚¦ã‚¶ã‚¢ãƒ—ãƒªã®ãƒã‚¤ã‚¯ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã—ã¦ãã ã•ã„ã€‚</li>
            </ul>
            <button class="modal-close-btn" id="closeMicrophoneGuideModal">OKã€ç†è§£ã—ã¾ã—ãŸ</button>
        </div>
    </div>

    <script>
        class VoiceAssistantPro {
            constructor() {
                this.recognition = null;
                this.isListening = false;
                this.finalTranscript = '';
                this.undoStack = [];
                this.redoStack = [];
                this.sessionStartTime = null;
                this.stats = this.loadStats();
                this.history = this.loadHistory();
                this.showMicrophoneGuideOnStartup = this.loadMicrophoneGuideSetting(); // ãƒã‚¤ã‚¯ã‚¬ã‚¤ãƒ‰è¨­å®šã‚’ãƒ­ãƒ¼ãƒ‰
                this.hasRequestedMicrophonePermission = false; // ãƒã‚¤ã‚¯è¨±å¯ã‚’ä¸€åº¦ã§ã‚‚è¦æ±‚ã—ãŸã‹ã©ã†ã‹ã®ãƒ•ãƒ©ã‚°
                this.downloadFormats = this.loadDownloadFormatSettings(); // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å½¢å¼è¨­å®šã‚’ãƒ­ãƒ¼ãƒ‰

                this.initElements();
                this.initSpeechRecognition();
                this.bindEvents();
                this.updateCharCount();
                this.updateStats();
                this.loadHistoryDisplay();
                this.applyDownloadFormatSettings(); // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å½¢å¼è¨­å®šã‚’é©ç”¨
                this.checkMicrophonePermissionAndShowGuide(); // ãƒã‚¤ã‚¯è¨±å¯ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€å¿…è¦ãªã‚‰ã‚¬ã‚¤ãƒ‰ã‚’è¡¨ç¤º
            }
            
            initElements() {
                this.micBtn = document.getElementById('micBtn');
                this.stopBtn = document.getElementById('stopBtn');
                this.copyBtn = document.getElementById('copyBtn');
                this.clearBtn = document.getElementById('clearBtn');
                this.saveBtn = document.getElementById('saveBtn');
                this.downloadBtn = document.getElementById('downloadBtn');
                this.downloadFormatCheckboxes = document.querySelectorAll('#downloadFormatOptions input[type="checkbox"]'); // å¤‰æ›´
                this.undoBtn = document.getElementById('undoBtn');
                this.redoBtn = document.getElementById('redoBtn');
                
                this.statusDisplay = document.getElementById('statusDisplay');
                this.textOutput = document.getElementById('textOutput');
                this.languageSelect = document.getElementById('language');
                this.charCount = document.getElementById('charCount');
                this.wordCount = document.getElementById('wordCount');
                
                this.totalSessions = document.getElementById('totalSessions');
                this.totalWords = document.getElementById('totalWords');
                this.totalTime = document.getElementById('totalTime');
                this.historyList = document.getElementById('historyList');
                
                this.templateItems = document.querySelectorAll('.template-item');

                // æ–°ã—ã„ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³
                this.resetHistoryBtn = document.getElementById('resetHistoryBtn');
                this.resetStatsBtn = document.getElementById('resetStatsBtn');

                // ãƒã‚¤ã‚¯ã‚¬ã‚¤ãƒ‰ãƒ¢ãƒ¼ãƒ€ãƒ«é–¢é€£è¦ç´ 
                this.microphoneGuideModal = document.getElementById('microphoneGuideModal');
                this.closeMicrophoneGuideModalBtn = document.getElementById('closeMicrophoneGuideModal');
                this.showMicrophoneGuideCheckbox = document.getElementById('showMicrophoneGuide');

                // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®åˆæœŸçŠ¶æ…‹ã‚’è¨­å®š
                this.showMicrophoneGuideCheckbox.checked = this.showMicrophoneGuideOnStartup;
            }
            
            initSpeechRecognition() {
                // ãƒ–ãƒ©ã‚¦ã‚¶ãŒéŸ³å£°èªè­˜APIã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹ã‹ç¢ºèª
                if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                    this.statusDisplay.textContent = 'éŸ³å£°èªè­˜éå¯¾å¿œãƒ–ãƒ©ã‚¦ã‚¶ã§ã™';
                    this.statusDisplay.className = 'status-display error';
                    this.micBtn.disabled = true;
                    return;
                }
                
                // SpeechRecognitionã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®åˆæœŸåŒ–
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                this.recognition = new SpeechRecognition();
                
                // ç¶™ç¶šçš„ãªèªè­˜ã¨ä¸­é–“çµæœã®å–å¾—ã‚’æœ‰åŠ¹ã«ã™ã‚‹
                this.recognition.continuous = true;
                this.recognition.interimResults = true;
                // é¸æŠã•ã‚ŒãŸè¨€èªã‚’è¨­å®š
                this.recognition.lang = this.languageSelect.value;
                
                // èªè­˜é–‹å§‹æ™‚ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©
                this.recognition.onstart = () => {
                    this.isListening = true;
                    this.sessionStartTime = Date.now(); // ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚é–“ã‚’è¨˜éŒ²
                    this.micBtn.classList.add('listening'); // ãƒã‚¤ã‚¯ãƒœã‚¿ãƒ³ã«ãƒªã‚¹ãƒ‹ãƒ³ã‚°ä¸­ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’é©ç”¨
                    this.micBtn.disabled = true; // ãƒã‚¤ã‚¯ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
                    this.stopBtn.disabled = false; // åœæ­¢ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
                    this.statusDisplay.textContent = 'èã„ã¦ã„ã¾ã™... è©±ã—ã¦ãã ã•ã„';
                    this.statusDisplay.className = 'status-display listening'; // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºã‚’æ›´æ–°
                };
                
                // èªè­˜çµæœãŒå¾—ã‚‰ã‚ŒãŸæ™‚ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©
                this.recognition.onresult = (event) => {
                    let interimTranscript = ''; // ä¸­é–“çµæœã‚’æ ¼ç´ã™ã‚‹å¤‰æ•°
                    
                    // ã™ã¹ã¦ã®èªè­˜çµæœã‚’ãƒ«ãƒ¼ãƒ—
                    for (let i = event.resultIndex; i < event.results.length; i++) {
                        const transcript = event.results[i][0].transcript;
                        
                        // æœ€çµ‚çµæœã¨ä¸­é–“çµæœã‚’åˆ†é›¢
                        if (event.results[i].isFinal) {
                            this.finalTranscript += transcript + ' '; // æœ€çµ‚çµæœã«è¿½åŠ 
                        } else {
                            interimTranscript += transcript; // ä¸­é–“çµæœã«è¿½åŠ 
                        }
                    }
                    
                    // ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã«æœ€çµ‚çµæœã¨ä¸­é–“çµæœã‚’è¡¨ç¤º
                    this.textOutput.value = this.finalTranscript + interimTranscript;
                    this.updateCharCount(); // æ–‡å­—æ•°ãƒ»å˜èªæ•°ã‚’æ›´æ–°
                };
                
                // ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©
                this.recognition.onerror = (event) => {
                    console.error('éŸ³å£°èªè­˜ã‚¨ãƒ©ãƒ¼:', event.error);
                    this.statusDisplay.textContent = `ã‚¨ãƒ©ãƒ¼: ${event.error}`;
                    this.statusDisplay.className = 'status-display error';
                    this.resetButtons(); // ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ

                    // ãƒã‚¤ã‚¯è¨±å¯ã‚¨ãƒ©ãƒ¼ã®å ´åˆã€ã‚¬ã‚¤ãƒ‰ã‚’è¡¨ç¤º
                    if (event.error === 'not-allowed' || event.error === 'permission-denied') {
                        this.showMicrophoneGuideModal();
                    }
                };
                
                // èªè­˜çµ‚äº†æ™‚ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©
                this.recognition.onend = () => {
                    this.isListening = false;
                    this.updateSessionStats(); // ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ±è¨ˆã‚’æ›´æ–°
                    
                    // ãƒã‚¤ã‚¯è¨±å¯ãŒæ—¢ã«è¦æ±‚ã•ã‚Œã¦ãŠã‚Šã€ã‹ã¤ã‚¬ã‚¤ãƒ‰è¡¨ç¤ºè¨­å®šãŒONã®å ´åˆã«è£œè¶³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ 
                    if (this.hasRequestedMicrophonePermission && this.showMicrophoneGuideOnStartup) {
                        this.statusDisplay.textContent = 'èªè­˜å®Œäº† - å†åº¦é–‹å§‹ã™ã‚‹ã«ã¯ãƒã‚¤ã‚¯ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚â€»ãƒ–ãƒ©ã‚¦ã‚¶ã®ä»•æ§˜ã«ã‚ˆã‚Šã€å†åº¦è¨±å¯ã‚’æ±‚ã‚ã‚‰ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚';
                    } else {
                        this.statusDisplay.textContent = 'èªè­˜å®Œäº† - å†åº¦é–‹å§‹ã™ã‚‹ã«ã¯ãƒã‚¤ã‚¯ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„';
                    }
                    this.statusDisplay.className = 'status-display';
                    this.resetButtons(); // ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
                };
            }
            
            // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®ãƒã‚¤ãƒ³ãƒ‰
            bindEvents() {
                this.micBtn.addEventListener('click', () => this.startRecognition());
                this.stopBtn.addEventListener('click', () => this.stopRecognition());
                this.copyBtn.addEventListener('click', () => this.copyText());
                this.clearBtn.addEventListener('click', () => this.clearText());
                this.saveBtn.addEventListener('click', () => this.saveToHistory());
                this.downloadBtn.addEventListener('click', () => this.downloadTextsInSelectedFormats()); // å¤‰æ›´
                this.undoBtn.addEventListener('click', () => this.undo());
                this.redoBtn.addEventListener('click', () => this.redo());

                // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å½¢å¼ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®å¤‰æ›´ã‚¤ãƒ™ãƒ³ãƒˆ
                this.downloadFormatCheckboxes.forEach(checkbox => {
                    checkbox.addEventListener('change', () => this.saveDownloadFormatSettings());
                });

                // ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆ
                this.resetHistoryBtn.addEventListener('click', () => this.resetHistory());
                this.resetStatsBtn.addEventListener('click', () => this.resetStats());
                
                // è¨€èªé¸æŠãŒå¤‰æ›´ã•ã‚ŒãŸã‚‰èªè­˜è¨€èªã‚’æ›´æ–°
                this.languageSelect.addEventListener('change', () => {
                    if (this.recognition) {
                        this.recognition.lang = this.languageSelect.value;
                    }
                });
                
                // ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã®å…¥åŠ›æ™‚ã«ã‚¢ãƒ³ãƒ‰ã‚¥ã‚¹ã‚¿ãƒƒã‚¯ã‚’æ›´æ–°ã—ã€æ–‡å­—æ•°ãƒ»å˜èªæ•°ã‚’æ›´æ–°
                this.textOutput.addEventListener('input', () => {
                    this.saveToUndoStack();
                    this.updateCharCount();
                });
                
                // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¢ã‚¤ãƒ†ãƒ ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
                this.templateItems.forEach(item => {
                    item.addEventListener('click', () => {
                        const template = item.dataset.template;
                        this.insertTemplate(template);
                    });
                });
                
                // ãƒã‚¤ã‚¯ã‚¬ã‚¤ãƒ‰ãƒ¢ãƒ¼ãƒ€ãƒ«ã®é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³
                this.closeMicrophoneGuideModalBtn.addEventListener('click', () => {
                    this.hideMicrophoneGuideModal();
                });

                // ãƒã‚¤ã‚¯ã‚¬ã‚¤ãƒ‰è¡¨ç¤ºè¨­å®šã®å¤‰æ›´
                this.showMicrophoneGuideCheckbox.addEventListener('change', (e) => {
                    this.showMicrophoneGuideOnStartup = e.target.checked;
                    this.saveMicrophoneGuideSetting();
                });

                // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ
                document.addEventListener('keydown', (e) => {
                    if (e.ctrlKey || e.metaKey) { // Ctrlã‚­ãƒ¼ã¾ãŸã¯Cmdã‚­ãƒ¼ãŒæŠ¼ã•ã‚Œã¦ã„ã‚‹å ´åˆ
                        switch(e.key) {
                            case 'm': // Ctrl/Cmd + M ã§éŒ²éŸ³é–‹å§‹/åœæ­¢
                                e.preventDefault();
                                if (!this.isListening) {
                                    this.startRecognition();
                                } else {
                                    this.stopRecognition();
                                }
                                break;
                            case 'z': // Ctrl/Cmd + Z ã§å…ƒã«æˆ»ã™, Ctrl/Cmd + Shift + Z ã§ã‚„ã‚Šç›´ã—
                                if (e.shiftKey) {
                                    e.preventDefault();
                                    this.redo();
                                } else {
                                    e.preventDefault();
                                    this.undo();
                                }
                                break;
                            case 's': // Ctrl/Cmd + S ã§å±¥æ­´ã«ä¿å­˜
                                e.preventDefault();
                                this.saveToHistory();
                                break;
                            case 'd': // Ctrl/Cmd + D ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                                e.preventDefault();
                                this.downloadTextsInSelectedFormats();
                                break;
                        }
                    }
                });
            }
            
            // éŸ³å£°èªè­˜ã‚’é–‹å§‹
            startRecognition() {
                if (!this.recognition) return;
                
                this.saveToUndoStack(); // ç¾åœ¨ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¢ãƒ³ãƒ‰ã‚¥ã‚¹ã‚¿ãƒƒã‚¯ã«ä¿å­˜
                
                try {
                    this.recognition.start();
                } catch (error) {
                    console.error('éŒ²éŸ³é–‹å§‹ã‚¨ãƒ©ãƒ¼:', error);
                    this.statusDisplay.textContent = 'éŒ²éŸ³é–‹å§‹ã«å¤±æ•—ã—ã¾ã—ãŸ';
                    this.statusDisplay.className = 'status-display error';
                    // ã‚¨ãƒ©ãƒ¼ãŒãƒã‚¤ã‚¯è¨±å¯é–¢é€£ã®å ´åˆã€ã‚¬ã‚¤ãƒ‰ã‚’è¡¨ç¤º
                    if (error.name === 'NotAllowedError' || error.name === 'PermissionDeniedError') {
                        this.showMicrophoneGuideModal();
                    }
                }
            }
            
            // éŸ³å£°èªè­˜ã‚’åœæ­¢
            stopRecognition() {
                if (this.recognition && this.isListening) {
                    this.recognition.stop();
                }
            }
            
            // ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã®å†…å®¹ã‚’ã‚¯ãƒªã‚¢
            clearText() {
                this.saveToUndoStack(); // ã‚¯ãƒªã‚¢å‰ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¢ãƒ³ãƒ‰ã‚¥ã‚¹ã‚¿ãƒƒã‚¯ã«ä¿å­˜
                this.textOutput.value = '';
                this.finalTranscript = '';
                this.updateCharCount();
                this.statusDisplay.textContent = 'ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ';
            }
            
            // ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼
            async copyText() {
                const text = this.textOutput.value;
                if (!text.trim()) {
                    this.statusDisplay.textContent = 'ã‚³ãƒ”ãƒ¼ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆãŒã‚ã‚Šã¾ã›ã‚“';
                    this.statusDisplay.className = 'status-display error';
                    return;
                }
                
                try {
                    await navigator.clipboard.writeText(text);
                    this.statusDisplay.textContent = 'ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼';
                    this.statusDisplay.className = 'status-display';
                } catch (error) {
                    console.error('ã‚³ãƒ”ãƒ¼ã‚¨ãƒ©ãƒ¼:', error);
                    this.textOutput.select();
                    this.statusDisplay.textContent = 'ãƒ†ã‚­ã‚¹ãƒˆã‚’é¸æŠã—ã¾ã—ãŸï¼ˆæ‰‹å‹•ã§ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ï¼‰';
                }
            }

            // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å½¢å¼ã«å¿œã˜ãŸãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆã¨MIMEã‚¿ã‚¤ãƒ—ãƒ»æ‹¡å¼µå­ã®å–å¾—
            getFormattedDownloadData(originalText, format) {
                let content = originalText;
                let mimeType = '';
                let extension = '';

                switch (format) {
                    case 'txt':
                        mimeType = 'text/plain;charset=utf-8';
                        extension = 'txt';
                        break;
                    case 'md':
                        mimeType = 'text/markdown;charset=utf-8';
                        extension = 'md';
                        break;
                    case 'html':
                        const escapedText = originalText.replace(/&/g, '&amp;')
                                                      .replace(/</g, '&lt;')
                                                      .replace(/>/g, '&gt;')
                                                      .replace(/"/g, '&quot;')
                                                      .replace(/'/g, '&#039;');
                        content = `<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Claude Voice Assistant Output</title>
</head>
<body>
    <pre>${escapedText}</pre>
</body>
</html>`;
                        mimeType = 'text/html;charset=utf-8';
                        extension = 'html';
                        break;
                    case 'json':
                        content = JSON.stringify({
                            title: `Claude Voice Assistant Output`,
                            content: originalText,
                            timestamp: new Date().toISOString()
                        }, null, 2); // 2ã‚¹ãƒšãƒ¼ã‚¹ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã§æ•´å½¢
                        mimeType = 'application/json;charset=utf-8';
                        extension = 'json';
                        break;
                    case 'csv':
                        const csvEscapedText = originalText.replace(/"/g, '""');
                        content = `"${csvEscapedText}"`; // å…¨ä½“ã‚’1ã¤ã®ã‚»ãƒ«ã¨ã—ã¦ä¿å­˜
                        mimeType = 'text/csv;charset=utf-8';
                        extension = 'csv';
                        break;
                    default:
                        mimeType = 'text/plain;charset=utf-8';
                        extension = 'txt';
                        break;
                }
                return { content, mimeType, extension };
            }

            // é¸æŠã•ã‚ŒãŸå…¨ã¦ã®å½¢å¼ã§ãƒ†ã‚­ã‚¹ãƒˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
            downloadTextsInSelectedFormats() {
                const originalText = this.textOutput.value;
                if (!originalText.trim()) {
                    this.statusDisplay.textContent = 'ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆãŒã‚ã‚Šã¾ã›ã‚“';
                    this.statusDisplay.className = 'status-display error';
                    return;
                }

                const checkedFormats = Array.from(this.downloadFormatCheckboxes)
                                            .filter(cb => cb.checked)
                                            .map(cb => ({
                                                format: cb.value,
                                                mimeType: cb.dataset.mimeType,
                                                extension: cb.dataset.extension
                                            }));

                if (checkedFormats.length === 0) {
                    this.statusDisplay.textContent = 'ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å½¢å¼ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚è¨­å®šã‹ã‚‰é¸ã‚“ã§ãã ã•ã„ã€‚';
                    this.statusDisplay.className = 'status-display error';
                    return;
                }

                // ãƒ•ã‚¡ã‚¤ãƒ«åã®æ—¥ä»˜éƒ¨åˆ†ã‚’ç”Ÿæˆ (YYYYMMDD_HH-MM)
                const now = new Date();
                const year = now.getFullYear();
                const month = (now.getMonth() + 1).toString().padStart(2, '0');
                const day = now.getDate().toString().padStart(2, '0');
                const hours = now.getHours().toString().padStart(2, '0');
                const minutes = now.getMinutes().toString().padStart(2, '0');
                const datetimePrefix = `${year}${month}${day}_${hours}-${minutes}`;

                let downloadedCount = 0;

                checkedFormats.forEach(({ format, mimeType, extension }) => {
                    const { content, mimeType: finalMimeType, extension: finalExtension } = this.getFormattedDownloadData(originalText, format);
                    const filename = `${datetimePrefix}.${finalExtension}`;

                    const blob = new Blob([content], { type: finalMimeType });
                    const a = document.createElement('a');
                    a.href = URL.createObjectURL(blob);
                    a.download = filename;
                    
                    // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’ãƒˆãƒªã‚¬ãƒ¼
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(a.href);
                    downloadedCount++;
                });

                this.statusDisplay.textContent = `${downloadedCount}å€‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸï¼`;
                this.statusDisplay.className = 'status-display';
            }
            
            // ãƒ†ã‚­ã‚¹ãƒˆã‚’å±¥æ­´ã«ä¿å­˜
            saveToHistory() {
                const text = this.textOutput.value;
                if (!text.trim()) {
                    this.statusDisplay.textContent = 'ä¿å­˜ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆãŒã‚ã‚Šã¾ã›ã‚“';
                    this.statusDisplay.className = 'status-display error';
                    return;
                }
                
                const historyItem = {
                    id: Date.now(), // ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªID
                    text: text,
                    date: new Date().toLocaleString('ja-JP'), // æ—¥æœ¬èªãƒ­ã‚±ãƒ¼ãƒ«ã§æ—¥ä»˜ã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
                    wordCount: this.countWords(text)
                };
                
                this.history.unshift(historyItem); // é…åˆ—ã®å…ˆé ­ã«è¿½åŠ 
                
                // æœ€å¤§100ä»¶ã¾ã§ä¿å­˜ã—ã€å¤ã„ã‚‚ã®ã‹ã‚‰å‰Šé™¤
                if (this.history.length > 100) {
                    this.history = this.history.slice(0, 100);
                }
                
                this.saveHistory(); // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
                this.loadHistoryDisplay(); // å±¥æ­´è¡¨ç¤ºã‚’æ›´æ–°
                this.statusDisplay.textContent = 'å±¥æ­´ã«ä¿å­˜ã—ã¾ã—ãŸ';
            }

            // å±¥æ­´ã®ãƒªã‚»ãƒƒãƒˆ
            resetHistory() {
                if (confirm('å…¨ã¦ã®å±¥æ­´ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ')) {
                    this.history = [];
                    this.saveHistory();
                    this.loadHistoryDisplay();
                    this.statusDisplay.textContent = 'å±¥æ­´ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ';
                    this.statusDisplay.className = 'status-display';
                }
            }

            // çµ±è¨ˆã®ãƒªã‚»ãƒƒãƒˆ
            resetStats() {
                if (confirm('å…¨ã¦ã®çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ')) {
                    this.stats = { totalSessions: 0, totalWords: 0, totalTime: 0 };
                    this.saveStats();
                    this.updateStats();
                    this.statusDisplay.textContent = 'çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ';
                    this.statusDisplay.className = 'status-display';
                }
            }
            
            // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã«æŒ¿å…¥
            insertTemplate(template) {
                this.saveToUndoStack(); // æŒ¿å…¥å‰ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¢ãƒ³ãƒ‰ã‚¥ã‚¹ã‚¿ãƒƒã‚¯ã«ä¿å­˜
                const cursorPos = this.textOutput.selectionStart; // ç¾åœ¨ã®ã‚«ãƒ¼ã‚½ãƒ«ä½ç½®
                const textBefore = this.textOutput.value.substring(0, cursorPos);
                const textAfter = this.textOutput.value.substring(cursorPos);
                
                this.textOutput.value = textBefore + template + textAfter; // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’æŒ¿å…¥
                this.textOutput.focus(); // ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
                // ã‚«ãƒ¼ã‚½ãƒ«ä½ç½®ã‚’ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®æœ«å°¾ã«ç§»å‹•
                this.textOutput.selectionStart = this.textOutput.selectionEnd = cursorPos + template.length;
                
                this.updateCharCount();
                this.statusDisplay.textContent = 'ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’æŒ¿å…¥ã—ã¾ã—ãŸ';
            }
            
            // ç¾åœ¨ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¢ãƒ³ãƒ‰ã‚¥ã‚¹ã‚¿ãƒƒã‚¯ã«ä¿å­˜
            saveToUndoStack() {
                // ç¾åœ¨ã®ãƒ†ã‚­ã‚¹ãƒˆãŒã‚¹ã‚¿ãƒƒã‚¯ã®æœ€å¾Œã¨åŒã˜å ´åˆã¯ä¿å­˜ã—ãªã„ï¼ˆé€£ç¶šå…¥åŠ›ã«ã‚ˆã‚‹é‡è¤‡ã‚’é˜²ãï¼‰
                if (this.undoStack.length > 0 && this.undoStack[this.undoStack.length - 1] === this.textOutput.value) {
                    return;
                }
                this.undoStack.push(this.textOutput.value);
                this.redoStack = []; // ã‚¢ãƒ³ãƒ‰ã‚¥ã—ãŸå ´åˆã¯ãƒªãƒ‰ã‚¥ã‚¹ã‚¿ãƒƒã‚¯ã‚’ã‚¯ãƒªã‚¢
                
                // æœ€å¤§50ä»¶ã¾ã§ä¿å­˜ã—ã€å¤ã„ã‚‚ã®ã‹ã‚‰å‰Šé™¤
                if (this.undoStack.length > 50) {
                    this.undoStack.shift();
                }
            }
            
            // å…ƒã«æˆ»ã™ (Undo)
            undo() {
                if (this.undoStack.length === 0) return;
                
                this.redoStack.push(this.textOutput.value); // ç¾åœ¨ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ãƒªãƒ‰ã‚¥ã‚¹ã‚¿ãƒƒã‚¯ã«ä¿å­˜
                this.textOutput.value = this.undoStack.pop(); // ã‚¹ã‚¿ãƒƒã‚¯ã‹ã‚‰ä¸€ã¤å‰ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’å–å¾—
                this.updateCharCount();
                this.statusDisplay.textContent = 'å…ƒã«æˆ»ã—ã¾ã—ãŸ';
            }
            
            // ã‚„ã‚Šç›´ã— (Redo)
            redo() {
                if (this.redoStack.length === 0) return;
                
                this.undoStack.push(this.textOutput.value); // ç¾åœ¨ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¢ãƒ³ãƒ‰ã‚¥ã‚¹ã‚¿ãƒƒã‚¯ã«ä¿å­˜
                this.textOutput.value = this.redoStack.pop(); // ã‚¹ã‚¿ãƒƒã‚¯ã‹ã‚‰ä¸€ã¤å¾Œã®ãƒ†ã‚­ã‚¹ãƒˆã‚’å–å¾—
                this.updateCharCount();
                this.statusDisplay.textContent = 'ã‚„ã‚Šç›´ã—ã¾ã—ãŸ';
            }
            
            // ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
            resetButtons() {
                this.micBtn.classList.remove('listening');
                this.micBtn.disabled = false;
                this.stopBtn.disabled = true;
            }
            
            // æ–‡å­—æ•°ã¨å˜èªæ•°ã‚’æ›´æ–°
            updateCharCount() {
                const text = this.textOutput.value;
                const charCount = text.length;
                const wordCount = this.countWords(text);
                
                this.charCount.textContent = charCount.toLocaleString();
                this.wordCount.textContent = wordCount.toLocaleString();
            }
            
            // ãƒ†ã‚­ã‚¹ãƒˆã®å˜èªæ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ (æ—¥æœ¬èªã¨è‹±èªã§ç•°ãªã‚‹ãƒ­ã‚¸ãƒƒã‚¯)
            countWords(text) {
                if (!text.trim()) return 0;
                
                // æ—¥æœ¬èªã®æ–‡å­—ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã¯æ–‡å­—æ•°ï¼ˆç©ºç™½ãªã—ï¼‰ã‚’è¿”ã™
                if (/[\u3400-\u9FBF]/.test(text)) { // Unicodeã®CJKçµ±åˆæ¼¢å­—ã®ç¯„å›²ã‚’ãƒã‚§ãƒƒã‚¯
                    return text.replace(/\s+/g, '').length;
                } else {
                    // è‹±èªã®å ´åˆã¯ã‚¹ãƒšãƒ¼ã‚¹ã§åŒºåˆ‡ã‚‰ã‚ŒãŸå˜èªæ•°ã‚’è¿”ã™
                    return text.trim().split(/\s+/).length;
                }
            }

            // ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ±è¨ˆã‚’æ›´æ–°
            updateSessionStats() {
                if (this.sessionStartTime) {
                    const sessionDuration = (Date.now() - this.sessionStartTime) / (1000 * 60); // ãƒŸãƒªç§’ã‹ã‚‰åˆ†ã«å¤‰æ›
                    this.stats.totalTime += sessionDuration;
                    this.stats.totalSessions++;
                    this.stats.totalWords += this.countWords(this.finalTranscript);
                    this.saveStats(); // çµ±è¨ˆã‚’ä¿å­˜
                    this.updateStats(); // çµ±è¨ˆè¡¨ç¤ºã‚’æ›´æ–°
                    this.sessionStartTime = null; // ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚é–“ã‚’ãƒªã‚»ãƒƒãƒˆ
                }
            }

            // çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰èª­ã¿è¾¼ã‚€
            loadStats() {
                try {
                    const stats = JSON.parse(localStorage.getItem('voiceAssistantStats')) || { totalSessions: 0, totalWords: 0, totalTime: 0 };
                    return stats;
                } catch (e) {
                    console.error("Failed to load stats:", e);
                    return { totalSessions: 0, totalWords: 0, totalTime: 0 };
                }
            }

            // çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜ã™ã‚‹
            saveStats() {
                localStorage.setItem('voiceAssistantStats', JSON.stringify(this.stats));
            }

            // çµ±è¨ˆè¡¨ç¤ºã‚’æ›´æ–°
            updateStats() {
                this.totalSessions.textContent = this.stats.totalSessions.toLocaleString();
                this.totalWords.textContent = this.stats.totalWords.toLocaleString();
                this.totalTime.textContent = this.stats.totalTime.toFixed(1); // å°æ•°ç‚¹ä»¥ä¸‹1æ¡ã§è¡¨ç¤º
            }

            // å±¥æ­´ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰èª­ã¿è¾¼ã‚€
            loadHistory() {
                try {
                    const history = JSON.parse(localStorage.getItem('voiceAssistantHistory')) || [];
                    return history;
                } catch (e) {
                    console.error("Failed to load history:", e);
                    return [];
                }
            }

            // å±¥æ­´ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜ã™ã‚‹
            saveHistory() {
                localStorage.setItem('voiceAssistantHistory', JSON.stringify(this.history));
            }

            // å±¥æ­´ãƒªã‚¹ãƒˆã‚’è¡¨ç¤ºã«åæ˜ 
            loadHistoryDisplay() {
                this.historyList.innerHTML = ''; // æ—¢å­˜ã®ãƒªã‚¹ãƒˆã‚’ã‚¯ãƒªã‚¢
                if (this.history.length === 0) {
                    this.historyList.innerHTML = '<p style="text-align: center; color: #999;">ã¾ã å±¥æ­´ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>';
                    return;
                }
                this.history.forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'history-item';
                    div.innerHTML = `
                        <div class="history-item-date">${item.date}</div>
                        <div class="history-item-text">${item.text}</div>
                    `;
                    // å±¥æ­´ã‚¢ã‚¤ãƒ†ãƒ ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã«å†…å®¹ã‚’ãƒ­ãƒ¼ãƒ‰
                    div.addEventListener('click', () => {
                        this.textOutput.value = item.text;
                        this.updateCharCount();
                        this.statusDisplay.textContent = 'å±¥æ­´ã‚’ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸ';
                    });
                    this.historyList.appendChild(div);
                });
            }

            // ãƒã‚¤ã‚¯è¨±å¯ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€å¿…è¦ã«å¿œã˜ã¦ã‚¬ã‚¤ãƒ‰ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤º
            async checkMicrophonePermissionAndShowGuide() {
                if (!this.showMicrophoneGuideOnStartup) {
                    return; // ã‚¬ã‚¤ãƒ‰è¡¨ç¤ºè¨­å®šãŒã‚ªãƒ•ã®å ´åˆã¯ä½•ã‚‚ã—ãªã„
                }

                try {
                    const permissionStatus = await navigator.permissions.query({ name: 'microphone' });

                    if (permissionStatus.state === 'granted') {
                        // ãƒã‚¤ã‚¯ãŒæ—¢ã«è¨±å¯ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤ºã—ãªã„
                        this.hasRequestedMicrophonePermission = true; // è¨±å¯ã•ã‚Œã¦ã„ã‚‹å ´åˆã‚‚ãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã‚‹
                        return;
                    } else if (permissionStatus.state === 'denied') {
                        // è¨±å¯ãŒæ‹’å¦ã•ã‚Œã¦ã„ã‚‹å ´åˆ
                        this.showMicrophoneGuideModal();
                    } else if (permissionStatus.state === 'prompt') {
                        // è¨±å¯ã‚’æ±‚ã‚ã‚‰ã‚Œã‚‹çŠ¶æ…‹ã®å ´åˆ
                        // ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã«ä¸€åº¦ã‚‚ãƒã‚¤ã‚¯è¨±å¯ã‚’è¦æ±‚ã—ã¦ã„ãªã‘ã‚Œã°ã€ã“ã“ã§è¦æ±‚ã™ã‚‹
                        if (!this.hasRequestedMicrophonePermission) {
                            try {
                                // recognition.start() ã‚’å‘¼ã³å‡ºã™ã“ã¨ã§ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒã‚¤ã‚¯è¨±å¯ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹
                                // ãŸã ã—ã€ã“ã“ã§ã¯å®Ÿéš›ã«éŒ²éŸ³ã‚’é–‹å§‹ã›ãšã€è¨±å¯ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ãƒˆãƒªã‚¬ãƒ¼ã®ã¿ã‚’ç›®çš„ã¨ã™ã‚‹
                                // ãã®ãŸã‚ã€ã™ãã« recognition.abort() ã‚’å‘¼ã³å‡ºã™
                                this.recognition.start();
                                this.recognition.abort(); // è¨±å¯ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¡¨ç¤ºå¾Œã™ãã«åœæ­¢
                            } catch (e) {
                                console.warn("Failed to trigger microphone permission prompt:", e);
                                // ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã‚‚ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚¬ã‚¤ãƒ‰ã‚’è¡¨ç¤ºã™ã‚‹
                                this.showMicrophoneGuideModal();
                            }
                            this.hasRequestedMicrophonePermission = true; // è¦æ±‚ãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã‚‹
                        }
                    }
                } catch (error) {
                    console.error('ãƒã‚¤ã‚¯è¨±å¯ã®ç¢ºèªä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
                    // ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã‚‚ã‚¬ã‚¤ãƒ‰ã‚’è¡¨ç¤ºã™ã‚‹
                    this.showMicrophoneGuideModal();
                }
            }

            // ãƒã‚¤ã‚¯ã‚¬ã‚¤ãƒ‰ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤º
            showMicrophoneGuideModal() {
                this.microphoneGuideModal.classList.add('active');
            }

            // ãƒã‚¤ã‚¯ã‚¬ã‚¤ãƒ‰ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’éè¡¨ç¤º
            hideMicrophoneGuideModal() {
                this.microphoneGuideModal.classList.remove('active');
            }

            // ãƒã‚¤ã‚¯ã‚¬ã‚¤ãƒ‰è¡¨ç¤ºè¨­å®šã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
            saveMicrophoneGuideSetting() {
                localStorage.setItem('showMicrophoneGuide', JSON.stringify(this.showMicrophoneGuideOnStartup));
            }

            // ãƒã‚¤ã‚¯ã‚¬ã‚¤ãƒ‰è¡¨ç¤ºè¨­å®šã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰ãƒ­ãƒ¼ãƒ‰
            loadMicrophoneGuideSetting() {
                try {
                    const setting = localStorage.getItem('showMicrophoneGuide');
                    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯trueï¼ˆè¡¨ç¤ºã™ã‚‹ï¼‰
                    return setting === null ? true : JSON.parse(setting);
                } catch (e) {
                    console.error("Failed to load microphone guide setting:", e);
                    return true; // ã‚¨ãƒ©ãƒ¼æ™‚ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§è¡¨ç¤ºã™ã‚‹
                }
            }

            // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å½¢å¼è¨­å®šã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰ãƒ­ãƒ¼ãƒ‰
            loadDownloadFormatSettings() {
                try {
                    const settings = JSON.parse(localStorage.getItem('downloadFormatSettings')) || {};
                    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯txtã®ã¿true
                    if (Object.keys(settings).length === 0) {
                        return { txt: true, md: false, html: false, json: false, csv: false };
                    }
                    return settings;
                } catch (e) {
                    console.error("Failed to load download format settings:", e);
                    return { txt: true, md: false, html: false, json: false, csv: false };
                }
            }

            // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å½¢å¼è¨­å®šã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
            saveDownloadFormatSettings() {
                const settings = {};
                this.downloadFormatCheckboxes.forEach(checkbox => {
                    settings[checkbox.value] = checkbox.checked;
                });
                localStorage.setItem('downloadFormatSettings', JSON.stringify(settings));
            }

            // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å½¢å¼è¨­å®šã‚’UIã«é©ç”¨
            applyDownloadFormatSettings() {
                this.downloadFormatCheckboxes.forEach(checkbox => {
                    checkbox.checked = this.downloadFormats[checkbox.value] || false;
                });
            }
        }

        // DOMContentLoadedã‚¤ãƒ™ãƒ³ãƒˆã§VoiceAssistantProã‚¯ãƒ©ã‚¹ã‚’åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', () => {
    const OPENAI_API_KEY = "YOUR_API_KEY_HERE"; // â†ã“ã“ã«APIã‚­ãƒ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„

    const summarizeBtn = document.getElementById("summarizeBtn");
    const textOutput = document.getElementById("textOutput"); 
    const statusDisplay = document.getElementById("statusDisplay"); 

    summarizeBtn.addEventListener("click", async () => {
      const originalText = textOutput.value.trim();
      if (!originalText) {
        statusDisplay.textContent = "è¦ç´„ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆãŒã‚ã‚Šã¾ã›ã‚“";
        statusDisplay.className = "status-display error";
        return;
      }

      statusDisplay.textContent = "è¦ç´„ä¸­...";
      statusDisplay.className = "status-display listening";

      try {
        const response = await fetch("https://api.openai.com/v1/chat/completions", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": `Bearer ${OPENAI_API_KEY}`
          },
          body: JSON.stringify({
            model: "gpt-3.5-turbo",
            messages: [
              { role: "system", content: "ä»¥ä¸‹ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’è¦ç‚¹ã ã‘5è¡Œä»¥å†…ã§ã¾ã¨ã‚ã¦ãã ã•ã„ã€‚" },
              { role: "user", content: originalText }
            ],
            temperature: 0.5
          })
        });

        const data = await response.json();
        const summary = data.choices?.[0]?.message?.content?.trim();
        if (summary) {
          textOutput.value += "\n\n---\nğŸ§  è¦ç´„:\n" + summary;
          statusDisplay.textContent = "è¦ç´„ãŒå®Œäº†ã—ã¾ã—ãŸ";
          statusDisplay.className = "status-display";
        } else {
          throw new Error("è¦ç´„çµæœãŒå–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸ");
        }
      } catch (err) {
        console.error("è¦ç´„ã‚¨ãƒ©ãƒ¼:", err);
        statusDisplay.textContent = "è¦ç´„ã«å¤±æ•—ã—ã¾ã—ãŸ: " + err.message;
        statusDisplay.className = "status-display error";
      }
    });

            new VoiceAssistantPro();
        });
    </script>
</body>
</html>
```

---
